[
  {
    "slug": [
      "auth",
      "passkeys"
    ],
    "url": "/auth/passkeys",
    "frontmatter": null,
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Environment (web):"
            }
          ]
        },
        {
          "type": "code",
          "language": "md",
          "code": "NEXT_PUBLIC_CONVEX_URL=https://<deployment>.convex.cloud\nEA_WEBAUTHN_RP_ID=auth.example.com # optional override for native apps\nEA_WEBAUTHN_ALLOWED_ORIGINS=https://foo.example,https://bar.example # optional extra origins"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "API endpoints:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "POST "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/auth/webauthn/begin/registration"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "POST "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/auth/webauthn/finish/registration"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "POST "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/auth/webauthn/begin/authentication"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "POST "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/auth/webauthn/finish/authentication"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "JS SDK usage:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\n// Register a passkey for current user (rpId/origins derived server-side)\nawait SDK.passkeys.register({\n  workspaceTenantId: \"default\",\n  userId: \"entities:1\",\n});\n\n// Sign-in with passkey (discoverable)\nconst result = await SDK.passkeys.signIn({ workspaceTenantId: \"default\" });\nconsole.log(result.accessToken);"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "RP ID and origins (web):"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "RP ID is derived from request host as eTLD+1 (e.g., "
                    },
                    {
                      "type": "inlineCode",
                      "value": "sub.example.co.uk"
                    },
                    {
                      "type": "text",
                      "value": " -> "
                    },
                    {
                      "type": "inlineCode",
                      "value": "example.co.uk"
                    },
                    {
                      "type": "text",
                      "value": ")."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Expected origins are computed as the current origin plus any "
                    },
                    {
                      "type": "inlineCode",
                      "value": "origin"
                    },
                    {
                      "type": "text",
                      "value": " entities linked to the workspace."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "These are stored on the challenge and enforced at finish."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Swift (EntityKit) usage:"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let config = EntityAuthConfig(baseURL: URL(string: \"https://api.example.com\")!)\nlet facade = EntityAuthFacade(config: config)\n// Register a passkey for the current user via native APIs\nlet _ = try await facade.registerPasskey(userId: userId, rpId: host, origins: [origin])\n// Sign in with a passkey (discoverable)\ntry await facade.signInWithPasskey(userId: nil, rpId: host, origins: [origin])"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Apple AASA and entitlements (native):"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Keep "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/.well-known/apple-app-site-association"
                    },
                    {
                      "type": "text",
                      "value": " listing bundle IDs."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "iOS/macOS apps must include Associated Domains with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "webcredentials:example.com"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": []
  },
  {
    "slug": [
      "authentication"
    ],
    "url": "/authentication",
    "frontmatter": {
      "title": "Authentication",
      "description": "Secure password authentication with JWT tokens and session management"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth provides secure password authentication with short-lived access tokens (15 minutes) and long-lived refresh tokens. Web clients receive refresh tokens as HTTP-only cookies, while mobile clients store them securely in Keychain."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "sdk-setup",
          "children": [
            {
              "type": "text",
              "value": "SDK Setup"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Web/Node.js:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\n// Automatically connects to configured base (defaults to entity-auth.com)\nconst auth = new EntityAuthClient();\n\n// Optional: For custom deployments\nconst customAuth = new EntityAuthClient({\n  baseURL: 'https://your-custom-domain.com'\n});"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "iOS/macOS:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "import EntityKit\n\nlet config = EntityAuthConfig(\n    environment: .production,\n    workspaceTenantId: \"your-tenant-id\",\n    clientIdentifier: \"ios-app\"\n)\nlet auth = EntityAuthFacade(config: config)"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "register",
          "children": [
            {
              "type": "text",
              "value": "Register"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={['Web','Swift']}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "await auth.register({\n  email: \"user@example.com\",\n  password: \"secure-password\",\n});"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await auth.register(request: .init(email: \"user@example.com\", password: \"secure-password\"))"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "login",
          "children": [
            {
              "type": "text",
              "value": "Login"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Authenticate users with email and password. Tenant is configured via init/env (not user input); the SDK includes it automatically. The SDK then manages access tokens for subsequent authenticated requests."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={['Web','Swift']}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "const result = await auth.login({\n  email: \"user@example.com\",\n  password: \"secure-password\",\n});\n// Returns: { accessToken, userId, sessionId }"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let facade = EntityAuthFacade(config: EntityAuthConfig(workspaceTenantId: \"tenant_123\"))\ntry await facade.login(request: LoginRequest(\n  email: \"user@example.com\",\n  password: \"secure-password\",\n  workspaceTenantId: \"tenant_123\"\n))\nlet snapshot = facade.currentSnapshot()\nprint(snapshot.userId ?? \"anonymous\")"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "token-management",
          "children": [
            {
              "type": "text",
              "value": "Token Management"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Access tokens"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " expire after 15 minutes for security"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Web"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Refresh tokens stored as HTTP-only "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ea_refresh"
                    },
                    {
                      "type": "text",
                      "value": " cookies"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Mobile"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Refresh tokens stored securely in iOS/macOS Keychain"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Auto-refresh"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": SDKs automatically refresh expired tokens"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Cross-origin mode"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EA_CROSS_ORIGIN_COOKIES=true"
                    },
                    {
                      "type": "text",
                      "value": " (and optional "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EA_COOKIE_DOMAIN"
                    },
                    {
                      "type": "text",
                      "value": ") to use "
                    },
                    {
                      "type": "inlineCode",
                      "value": "SameSite=None; Secure"
                    },
                    {
                      "type": "text",
                      "value": " refresh cookies for third-party origins."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// middleware.ts\n\n\nexport function middleware(request: NextRequest) {\n  const refresh = request.cookies.get('ea_refresh');\n  if (!refresh && request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.redirect(new URL('/login', request.url));\n  }\n  return NextResponse.next();\n}\n\nexport const config = { matcher: ['/dashboard/:path*'] };"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "See "
            },
            {
              "type": "link",
              "url": "/docs/frameworks",
              "children": [
                {
                  "type": "text",
                  "value": "Framework Integration"
                }
              ]
            },
            {
              "type": "text",
              "value": " for details.\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "token-refresh",
          "children": [
            {
              "type": "text",
              "value": "Token Refresh"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Web requests made through "
            },
            {
              "type": "inlineCode",
              "value": "auth.fetch()"
            },
            {
              "type": "text",
              "value": " automatically refresh on 401 responses. You can also refresh manually:"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={['Web','Swift']}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "await auth.refresh();"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let facade = EntityAuthFacade(config: EntityAuthConfig(workspaceTenantId: \"tenant_123\"))\ntry await facade.refreshTokens()"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "session-management",
          "children": [
            {
              "type": "text",
              "value": "Session Management"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Sessions are managed by the platform:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Web: Use "
                    },
                    {
                      "type": "inlineCode",
                      "value": "login"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "refresh"
                    },
                    {
                      "type": "text",
                      "value": ", and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "logout"
                    },
                    {
                      "type": "text",
                      "value": ". The JS SDK does not expose list/revoke APIs."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Swift: Use "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EntityKit"
                    },
                    {
                      "type": "text",
                      "value": " session services as shown below."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Swift:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let facade = EntityAuthFacade(config: EntityAuthConfig(workspaceTenantId: \"tenant_123\"))\nlet current = try await facade.sessionService.current()\nlet sessions = try await facade.sessionService.list(includeRevoked: false)\ntry await facade.sessionService.revoke(sessionId: \"session-id\")\ntry await facade.sessionService.revokeByUser(userId: \"user-id\")"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "logout",
          "children": [
            {
              "type": "text",
              "value": "Logout"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={['Web','Swift']}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "await auth.logout();"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await auth.logout()"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "security-features",
          "children": [
            {
              "type": "text",
              "value": "Security Features"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "cross-origin-setup-web",
          "children": [
            {
              "type": "text",
              "value": "Cross-Origin Setup (Web)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Workspaces have their own allowlist. Localhost origins are pre-seeded; add production domains in the dashboard:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Dashboard → Setup → Allowed Origins"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Click "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Add Origin"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " and enter your domain ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://app.example.com"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "The middleware automatically replies with the correct "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Access-Control-Allow-Origin"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "authentication-flow",
          "children": [
            {
              "type": "text",
              "value": "Authentication Flow"
            }
          ]
        },
        {
          "type": "code",
          "code": "Set up the Entity Auth client (automatically connects to entity-auth.com).\n\n```typescript\nconst auth = new EntityAuthClient();\n```"
        },
        {
          "type": "code",
          "code": "Authenticate users with email/password and tenant ID."
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "await auth.login({\n  email: \"user@example.com\",\n  password: \"secure-password\",\n});\n    ```\n  </Step>\n\n  <Step>\n    ### Make Authenticated Requests\n\n    Use the SDK's fetch method for automatic token management.\n\n    ```typescript\n    const response = await auth.fetch('/api/protected-endpoint');\n    ```\n  </Step>\n\n  <Step>\n    ### Handle Token Refresh\n\n    SDKs automatically refresh expired tokens and retry failed requests.\n  </Step>\n\n  <Step>\n    ### Monitor Sessions\n\n    Track authentication state and handle remote logout events.\n\n    ```typescript\n    auth.onTokenChange((token) => {\n      if (token) {\n        // User authenticated\n      } else {\n        // User logged out\n      }\n    });\n    ```\n  </Step>\n</Steps>\n\n## See also\n\n- [Tenant Onboarding](/docs/tenant-onboarding) — find your tenant ID and start quickly\n- [Framework Integration](/docs/frameworks) — React/Next.js hooks and providers\n- [Demo Dashboard Guide](/docs/demo) — replicate the demo features"
        }
      ]
    },
    "toc": [
      {
        "title": "SDK Setup",
        "id": "sdk-setup",
        "depth": 2,
        "children": []
      },
      {
        "title": "Register",
        "id": "register",
        "depth": 2,
        "children": []
      },
      {
        "title": "Login",
        "id": "login",
        "depth": 2,
        "children": []
      },
      {
        "title": "Token Management",
        "id": "token-management",
        "depth": 2,
        "children": []
      },
      {
        "title": "Token Refresh",
        "id": "token-refresh",
        "depth": 2,
        "children": []
      },
      {
        "title": "Session Management",
        "id": "session-management",
        "depth": 2,
        "children": []
      },
      {
        "title": "Logout",
        "id": "logout",
        "depth": 2,
        "children": []
      },
      {
        "title": "Security Features",
        "id": "security-features",
        "depth": 2,
        "children": [
          {
            "title": "Cross-Origin Setup (Web)",
            "id": "cross-origin-setup-web",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Authentication Flow",
        "id": "authentication-flow",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "cli"
    ],
    "url": "/cli",
    "frontmatter": {
      "title": "Entity Auth CLI",
      "description": "One command for AI agents to discover capabilities, read docs, install UI, and scaffold templates"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "what-is-it",
          "children": [
            {
              "type": "text",
              "value": "What is it?"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The Entity Auth CLI lets AI agents and developers interact with Entity Auth through a single, discoverable capability graph. Running one command emits the full set of available actions, so an AI agent never needs to guess follow‑ups."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "one-command-to-expose-the-graph",
          "children": [
            {
              "type": "text",
              "value": "One command to expose the graph"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "npx @entityauth/cli@latest init entity-auth"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "What you get back:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "A JSON graph of all available nodes (capabilities):"
                    }
                  ]
                },
                {
                  "type": "list",
                  "ordered": false,
                  "children": [
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "strong",
                              "children": [
                                {
                                  "type": "text",
                                  "value": "Docs"
                                }
                              ]
                            },
                            {
                              "type": "text",
                              "value": " — content articles you can read programmatically"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "strong",
                              "children": [
                                {
                                  "type": "text",
                                  "value": "Components"
                                }
                              ]
                            },
                            {
                              "type": "text",
                              "value": " — UI components you can install into your app"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "strong",
                              "children": [
                                {
                                  "type": "text",
                                  "value": "Setup"
                                }
                              ]
                            },
                            {
                              "type": "text",
                              "value": " — app templates you can scaffold end‑to‑end"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "A "
                    },
                    {
                      "type": "inlineCode",
                      "value": "command_shapes"
                    },
                    {
                      "type": "text",
                      "value": " section that shows the exact command templates to run each capability"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Agents can parse this output and proceed end‑to‑end with no additional discovery commands."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "capabilities",
          "children": [
            {
              "type": "text",
              "value": "Capabilities"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "read-product-docs",
          "children": [
            {
              "type": "text",
              "value": "Read product docs"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "# Read any doc by node id from the graph\nnpx @entityauth/cli docs read entity-auth --node entityauth:docs:quickstart"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use this to pull structured content (e.g., Quickstart, Authentication, Organizations) directly from the bundled docs."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "install-ui-components",
          "children": [
            {
              "type": "text",
              "value": "Install UI components"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "# Install all components\nnpx @entityauth/cli ui install entity-auth --mode all\n\n# Or select specific components by name\nnpx @entityauth/cli ui install entity-auth --mode multiple --names auth-form"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Components are written into your project with deterministic paths and overwrite‑on‑write semantics."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "scaffold-app-templates-setup",
          "children": [
            {
              "type": "text",
              "value": "Scaffold app templates (Setup)"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "# Scaffold a Next.js + Entity Auth baseline and place files under ./entity-auth\nnpx @entityauth/cli setup run entity-auth --node entityauth:setup:basic\n\n# Optional: choose a workspace directory\nnpx @entityauth/cli setup run entity-auth --node entityauth:setup:basic --workspace /path/to/app"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Setup nodes can run non‑interactive scaffold commands (like "
            },
            {
              "type": "inlineCode",
              "value": "create-next-app"
            },
            {
              "type": "text",
              "value": ") and then copy ready‑to‑use "
            },
            {
              "type": "inlineCode",
              "value": "entity-auth/"
            },
            {
              "type": "text",
              "value": " files ("
            },
            {
              "type": "inlineCode",
              "value": "client.ts"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "provider.tsx"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "middleware.ts"
            },
            {
              "type": "text",
              "value": ", and components/)."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "how-agents-should-use-it",
          "children": [
            {
              "type": "text",
              "value": "How agents should use it"
            }
          ]
        },
        {
          "type": "code",
          "code": "Run `npx @entityauth/cli@latest init entity-auth` and read the JSON. The graph includes all `nodes` plus `command_shapes` showing exactly how to invoke each capability."
        },
        {
          "type": "code",
          "code": "Choose the relevant node by id (e.g., `entityauth:setup:basic`) and run the corresponding command template (e.g., `setup run ...`)."
        },
        {
          "type": "code",
          "code": "No hidden prerequisites. If inputs are missing, the CLI returns a single JSON error envelope describing required keys."
        },
        {
          "type": "code",
          "code": "The model never needs to ask for help; everything required is visible in the emitted graph."
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "examples",
          "children": [
            {
              "type": "text",
              "value": "Examples"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "# 1) Discover capabilities\nnpx @entityauth/cli@latest init entity-auth\n\n# 2) Read a doc\nnpx @entityauth/cli docs read entity-auth --node entityauth:docs:authentication\n\n# 3) Install UI\nnpx @entityauth/cli ui install entity-auth --mode all\n\n# 4) Scaffold a Next.js template\nnpx @entityauth/cli setup run entity-auth --node entityauth:setup:basic"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "platform-support",
          "children": [
            {
              "type": "text",
              "value": "Platform support"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "macOS Apple Silicon (arm64) only for now. The npm package downloads a native binary."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Intel macOS, Windows, and Linux are planned but not yet supported."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "troubleshooting",
          "children": [
            {
              "type": "text",
              "value": "Troubleshooting"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If "
                    },
                    {
                      "type": "inlineCode",
                      "value": "postinstall"
                    },
                    {
                      "type": "text",
                      "value": " fails: ensure network access and that your environment is "
                    },
                    {
                      "type": "inlineCode",
                      "value": "darwin/arm64"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If a command returns a JSON error: provide the fields indicated in the error payload and retry once."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "What is it?",
        "id": "what-is-it",
        "depth": 2,
        "children": []
      },
      {
        "title": "One command to expose the graph",
        "id": "one-command-to-expose-the-graph",
        "depth": 2,
        "children": []
      },
      {
        "title": "Capabilities",
        "id": "capabilities",
        "depth": 2,
        "children": [
          {
            "title": "Read product docs",
            "id": "read-product-docs",
            "depth": 3,
            "children": []
          },
          {
            "title": "Install UI components",
            "id": "install-ui-components",
            "depth": 3,
            "children": []
          },
          {
            "title": "Scaffold app templates (Setup)",
            "id": "scaffold-app-templates-setup",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "How agents should use it",
        "id": "how-agents-should-use-it",
        "depth": 2,
        "children": []
      },
      {
        "title": "Examples",
        "id": "examples",
        "depth": 2,
        "children": []
      },
      {
        "title": "Platform support",
        "id": "platform-support",
        "depth": 2,
        "children": []
      },
      {
        "title": "Troubleshooting",
        "id": "troubleshooting",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "demo"
    ],
    "url": "/demo",
    "frontmatter": {
      "title": "Demo Dashboard Guide",
      "description": "Recreate the demo dashboard features in your app"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "This guide maps the demo dashboard features to SDK calls and example UI patterns so you can implement the same flows in your product."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "authentication-login-register",
          "children": [
            {
              "type": "text",
              "value": "Authentication (Login / Register)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use the SDK to register and login users."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient();\n\nawait SDK.register({ email, password });\nawait SDK.login({ email, password });"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "profile-management-username",
          "children": [
            {
              "type": "text",
              "value": "Profile Management (Username)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Users can set a unique username and see updates in real‑time."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// Username flows are managed via generic entities in the new model\n// Example: update user entity properties with entities.update"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "UI pattern:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Input field bound to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "username"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Debounced "
                    },
                    {
                      "type": "inlineCode",
                      "value": "checkUsername()"
                    },
                    {
                      "type": "text",
                      "value": " on change"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Submit to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "setUsername()"
                    },
                    {
                      "type": "text",
                      "value": " and display result"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "organizations-create-switch",
          "children": [
            {
              "type": "text",
              "value": "Organizations (Create, Switch)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Create an organization and switch between them."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// Create org via generic entities\nconst me = await SDK.me();\nawait SDK.createEntity({\n  workspaceTenantId: me.workspaceTenantId!,\n  kind: 'org',\n  properties: { name: 'Acme', slug: 'acme', ownerId: me.id },\n});\n// Switch org is now modeled via session/tenant context, not a legacy method"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "UI pattern:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "List orgs via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ea.getUserOrganizations()"
                    },
                    {
                      "type": "text",
                      "value": " (canonical "
                    },
                    {
                      "type": "inlineCode",
                      "value": "OrganizationSummary[]"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Button to create org (name + slug)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Dropdown to switch active org"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "sessions-list-current-revoke",
          "children": [
            {
              "type": "text",
              "value": "Sessions (List, Current, Revoke)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "List sessions and allow the user to revoke sessions."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// Sessions are managed via auth endpoints; generic model does not expose legacy session list/revoke here"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "UI pattern:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Table of sessions (device, createdAt, lastActive)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Badge on the current session"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Action to revoke others"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "protected-routes",
          "children": [
            {
              "type": "text",
              "value": "Protected Routes"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use a simple guard to render authenticated content."
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "function Protected({ children }: { children: React.ReactNode }) {\n  const [token, setToken] = useState(ea.getAccessToken());\n  useEffect(() => ea.onTokenChange(setToken), []);\n  if (!token) return <div>Please log in</div>;\n  return <>{children}</>;\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "putting-it-together-reactnextjs",
          "children": [
            {
              "type": "text",
              "value": "Putting it Together (React/Next.js)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "See the "
            },
            {
              "type": "link",
              "url": "/docs/frameworks",
              "children": [
                {
                  "type": "text",
                  "value": "Framework Integration"
                }
              ]
            },
            {
              "type": "text",
              "value": " guide for ready‑to‑use hooks and providers, including "
            },
            {
              "type": "inlineCode",
              "value": "useSessions()"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "useOrganizations()"
            },
            {
              "type": "text",
              "value": " examples."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "troubleshooting",
          "children": [
            {
              "type": "text",
              "value": "Troubleshooting"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If session revocation doesn’t reflect, ensure you reload the list after actions."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If org switching appears no‑op, confirm the user has access to the target org and re‑fetch orgs after switching."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "For cross‑origin web apps, set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EA_CROSS_ORIGIN_COOKIES=true"
                    },
                    {
                      "type": "text",
                      "value": " on the server."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Authentication (Login / Register)",
        "id": "authentication-login-register",
        "depth": 2,
        "children": []
      },
      {
        "title": "Profile Management (Username)",
        "id": "profile-management-username",
        "depth": 2,
        "children": []
      },
      {
        "title": "Organizations (Create, Switch)",
        "id": "organizations-create-switch",
        "depth": 2,
        "children": []
      },
      {
        "title": "Sessions (List, Current, Revoke)",
        "id": "sessions-list-current-revoke",
        "depth": 2,
        "children": []
      },
      {
        "title": "Protected Routes",
        "id": "protected-routes",
        "depth": 2,
        "children": []
      },
      {
        "title": "Putting it Together (React/Next.js)",
        "id": "putting-it-together-reactnextjs",
        "depth": 2,
        "children": []
      },
      {
        "title": "Troubleshooting",
        "id": "troubleshooting",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "frameworks"
    ],
    "url": "/frameworks",
    "frontmatter": {
      "title": "Framework Integration",
      "description": "Using Entity Auth with React, Next.js, and other popular frameworks"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth works seamlessly with popular web frameworks. Here are integration patterns for the most common scenarios."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "react-integration",
          "children": [
            {
              "type": "text",
              "value": "React Integration"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "recommended-entityauthreact",
          "children": [
            {
              "type": "text",
              "value": "Recommended: @entityauth/react"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use the official provider and hooks instead of rolling your own. Create a single facade instance and pass it to the provider."
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "// app/entity-auth/facade.ts\n\nexport const entityAuthFacade = createEntityAuthFacade({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n  initialSnapshot: { isLoadingUser: true },\n});\n\n// app/layout.tsx (or your root)\n\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <EntityAuthProvider facade={entityAuthFacade}>{children}</EntityAuthProvider>\n      </body>\n    </html>\n  );\n}\n\nexport function Example() {\n  const { isAuthenticated, login, logout } = useEntityAuth();\n  const { me, loading } = useMe<{ id: string; email: string | null }>();\n  return (\n    <div>\n      <div>Authenticated: {String(isAuthenticated)}</div>\n      {loading ? 'Loading…' : <pre>{JSON.stringify(me, null, 2)}</pre>}\n      <button onClick={() => login({ email: 'a@b.com', password: 'secret' })}>Login</button>\n      <button onClick={() => logout()}>Logout</button>\n    </div>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "using-the-hook-in-components",
          "children": [
            {
              "type": "text",
              "value": "Using the Hook in Components"
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// components/LoginForm.tsx\n\n\nexport function LoginForm() {\n  const { login, loading, isAuthenticated } = useEntityAuth();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    const success = await login(email, password);\n    if (success) {\n      console.log('Login successful!');\n    }\n  };\n\n  if (isAuthenticated) {\n    return <div>Already logged in!</div>;\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input\n        type=\"email\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        placeholder=\"Email\"\n        required\n      />\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        required\n      />\n      <button type=\"submit\" disabled={loading}>\n        {loading ? 'Signing in...' : 'Sign In'}\n      </button>\n    </form>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "protected-routes",
          "children": [
            {
              "type": "text",
              "value": "Protected Routes"
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// components/ProtectedRoute.tsx\n\nexport function ProtectedRoute({ children }: { children: React.ReactNode }) {\n  const { isAuthenticated, loading } = useEntityAuth();\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  if (!isAuthenticated) {\n    return <div>Please log in to access this page.</div>;\n  }\n\n  return <>{children}</>;\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "nextjs-integration",
          "children": [
            {
              "type": "text",
              "value": "Next.js Integration"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "app-router-recommended",
          "children": [
            {
              "type": "text",
              "value": "App Router (Recommended)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Client Component for Authentication:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// components/auth-provider.tsx\n'use client';\n\n\n\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient();\n\ninterface AuthContextType {\n  user: any | null;\n  isAuthenticated: boolean;\n  loading: boolean;\n  login: (email: string, password: string) => Promise<boolean>;\n  logout: () => Promise<void>;\n  ea: EntityAuthClient;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<any | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const initAuth = async () => {\n      await ea.ready();\n      const token = ea.getAccessToken();\n      if (token) {\n        try {\n          const userData = await ea.me();\n          setUser(userData);\n        } catch (error) {\n          console.error('Failed to load user:', error);\n        }\n      }\n      setLoading(false);\n    };\n\n    initAuth();\n    const initAuth = async () => {\n      await ea.ready();\n      const token = ea.getAccessToken();\n      if (token) {\n        try {\n          const userData = await ea.me();\n          setUser(userData);\n        } catch (error) {\n          console.error('Failed to load user:', error);\n        }\n      }\n      setLoading(false);\n    };\n\n    initAuth();\n\n    const unsubscribe = ea.onTokenChange(async (token) => {\n      if (token) {\n        try {\n          const userData = await ea.getUserMe();\n          setUser(userData);\n        } catch (error) {\n          setUser(null);\n        }\n      } else {\n        setUser(null);\n      }\n    });\n\n    return unsubscribe;\n  }, []);\n\n  const login = async (email: string, password: string) => {\n    try {\n      await ea.login({ email, password });\n      return true;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const logout = async () => {\n    await ea.logout();\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isAuthenticated: !!user,\n        loading,\n        login,\n        logout,\n        ea\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Root Layout:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// app/layout.tsx\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <AuthProvider>\n          {children}\n        </AuthProvider>\n      </body>\n    </html>\n  );\n}"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Middleware for Protected Routes & SSO:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// middleware.ts\n\n\nexport function middleware(request: NextRequest) {\n  return entityAuthMiddleware(request, {\n    entityAuthUrl: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL || 'https://entity-auth.com',\n    workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID || '',\n    protectedRoutes: ['/dashboard/*', '/profile', '/settings'],\n    publicRoutes: ['/', '/pricing'],\n    loginUrl: '/auth',\n  });\n}\n\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],\n};"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "This middleware automatically:"
                }
              ]
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ Exchanges SSO tickets server-side (no page reloads!)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ Protects authenticated routes"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ Redirects unauthenticated users to login"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ Handles cross-domain cookies properly"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "pages-router-legacy",
          "children": [
            {
              "type": "text",
              "value": "Pages Router (Legacy)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "For Next.js with Pages Router:"
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// pages/_app.tsx\n\n\nexport default function App({ Component, pageProps }: AppProps) {\n  return (\n    <AuthProvider>\n      <Component {...pageProps} />\n    </AuthProvider>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "advanced-patterns",
          "children": [
            {
              "type": "text",
              "value": "Advanced Patterns"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "organization-context",
          "children": [
            {
              "type": "text",
              "value": "Organization Context"
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "// hooks/useOrganizations.ts\n\n\nexport function useOrganizations() {\n  const { ea } = useAuth();\n  const [organizations, setOrganizations] = useState([]);\n  const [currentOrg, setCurrentOrg] = useState(null);\n\n  const loadOrganizations = useCallback(async () => {\n    try {\n      const me = await ea.me();\n      const links = await SDK.queryRelations({ srcId: me.id, relation: 'member_of' });\n      const orgs = await Promise.all(links.map((l) => SDK.getEntity({ id: l.dstId })));\n      setOrganizations(orgs);\n      setCurrentOrg(orgs.find((o) => o.id === me.workspaceTenantId) ?? null);\n    } catch (error) {\n      console.error('Failed to load organizations:', error);\n    }\n  }, [ea]);\n\n  useEffect(() => {\n    loadOrganizations();\n  }, [loadOrganizations]);\n\n  const switchOrganization = useCallback(async (orgId: string) => {\n    try {\n      setCurrentOrg(organizations.find((o) => o.id === orgId) ?? null);\n    } catch (error) {\n      console.error('Failed to switch organization:', error);\n    }\n  }, [organizations]);\n\n  const createOrganization = useCallback(async (name: string, slug: string) => {\n    try {\n      const me = await ea.me();\n      const org = await SDK.createEntity({\n        workspaceTenantId: me.workspaceTenantId!,\n        kind: 'org',\n        properties: { name, slug, ownerId: me.id },\n      });\n      await SDK.linkRelation({\n        workspaceTenantId: me.workspaceTenantId!,\n        srcId: me.id,\n        relation: 'member_of',\n        dstId: org.id,\n        attrs: { role: 'owner' },\n      });\n      await loadOrganizations();\n    } catch (error) {\n      console.error('Failed to create organization:', error);\n    }\n  }, [ea, loadOrganizations]);\n\n  return {\n    organizations,\n    currentOrg,\n    switchOrganization,\n    createOrganization,\n    refetch: loadOrganizations\n  };\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "session-management",
          "children": [
            {
              "type": "text",
              "value": "Session Management"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Sessions are managed via "
            },
            {
              "type": "inlineCode",
              "value": "login"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "refresh"
            },
            {
              "type": "text",
              "value": ", and "
            },
            {
              "type": "inlineCode",
              "value": "logout"
            },
            {
              "type": "text",
              "value": ". The JS SDK does not expose list/revoke APIs; build UI around authentication state via "
            },
            {
              "type": "inlineCode",
              "value": "ea.onTokenChange"
            },
            {
              "type": "text",
              "value": " and "
            },
            {
              "type": "inlineCode",
              "value": "ea.getAccessToken()"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "best-practices",
          "children": [
            {
              "type": "text",
              "value": "Best Practices"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Use the SDK's built-in token management"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Don't try to manage tokens manually"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Handle loading states"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Authentication state changes are async"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Implement proper error handling"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Network requests can fail"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Use TypeScript"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - The SDK includes full type definitions"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Test authentication flows"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Include login, logout, and token refresh scenarios"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "example-application-structure",
          "children": [
            {
              "type": "text",
              "value": "Example Application Structure"
            }
          ]
        },
        {
          "type": "code",
          "code": "src/\n├── hooks/\n│   ├── useEntityAuth.ts\n│   ├── useOrganizations.ts\n│   └── useSessions.ts\n├── components/\n│   ├── AuthProvider.tsx\n│   ├── LoginForm.tsx\n│   ├── ProtectedRoute.tsx\n│   └── OrganizationSwitcher.tsx\n├── pages/ (or app/ for App Router)\n│   ├── login.tsx\n│   ├── dashboard.tsx\n│   └── profile.tsx\n└── lib/\n    └── auth.ts (SDK instance)"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "This structure provides a solid foundation for integrating Entity Auth into any React or Next.js application while maintaining security best practices and a good developer experience."
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "React Integration",
        "id": "react-integration",
        "depth": 2,
        "children": [
          {
            "title": "Recommended: @entityauth/react",
            "id": "recommended-entityauthreact",
            "depth": 3,
            "children": []
          },
          {
            "title": "Using the Hook in Components",
            "id": "using-the-hook-in-components",
            "depth": 3,
            "children": []
          },
          {
            "title": "Protected Routes",
            "id": "protected-routes",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Next.js Integration",
        "id": "nextjs-integration",
        "depth": 2,
        "children": [
          {
            "title": "App Router (Recommended)",
            "id": "app-router-recommended",
            "depth": 3,
            "children": []
          },
          {
            "title": "Pages Router (Legacy)",
            "id": "pages-router-legacy",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Advanced Patterns",
        "id": "advanced-patterns",
        "depth": 2,
        "children": [
          {
            "title": "Organization Context",
            "id": "organization-context",
            "depth": 3,
            "children": []
          },
          {
            "title": "Session Management",
            "id": "session-management",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Best Practices",
        "id": "best-practices",
        "depth": 2,
        "children": []
      },
      {
        "title": "Example Application Structure",
        "id": "example-application-structure",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [],
    "url": "/",
    "frontmatter": {
      "title": "Getting Started",
      "description": "Everything you need to get started with Entity Auth"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth provides complete authentication infrastructure with password auth, multi-tenant organizations, session management, and enterprise security for web and mobile applications."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "quick-links",
          "children": [
            {
              "type": "text",
              "value": "Quick Links"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Card title=\"Organizations\" description=\"Multi-tenant architecture\" href=\"/docs/organizations\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>Create organizations, manage members, and switch contexts."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"Web SDK\" href=\"/docs/sdk-js\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>TypeScript/JavaScript client for web applications."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"Swift SDK\" href=\"/docs/sdk-swift\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>Native iOS and macOS client library."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"SSO\" href=\"/docs/sso\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>OAuth/OIDC for web and mobile with PKCE."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"Tenant Onboarding\" href=\"/docs/tenant-onboarding\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>Find your tenant ID and connect your app."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"Frameworks\" href=\"/docs/frameworks\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>React and Next.js integration patterns."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n<Card title=\"Demo Dashboard\" href=\"/docs/demo\" icon={"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "}>Recreate all demo features in your app."
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "installation",
          "children": [
            {
              "type": "text",
              "value": "Installation"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Web/Node.js:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "npm install @entityauth/auth-client"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "iOS/macOS:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "// Add to Package.swift dependencies\n.package(url: \"https://github.com/entityauth/EntityKit.git\", from: \"1.0.0\")\n\n// NOTE: If using Convex, replace github.com/get-convex/convex-swift \n// with github.com/entityauth/convex-swift to avoid package conflicts"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "getting-started",
          "children": [
            {
              "type": "text",
              "value": "Getting Started"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth is a hosted authentication service. To get started:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Install the SDK"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " for your platform"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Get a tenant ID"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " from the Entity Auth dashboard"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Start integrating"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - SDKs automatically connect to entity-auth.com"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "features",
          "children": [
            {
              "type": "text",
              "value": "Features"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth provides:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Secure authentication"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " with Argon2 password hashing"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Real-time session monitoring"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " via Convex backend"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Multi-tenant organizations"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " with role-based access"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Enterprise security"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " with rate limiting and audit logging"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "basic-usage",
          "children": [
            {
              "type": "text",
              "value": "Basic Usage"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Web:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst auth = new EntityAuthClient();\n\nawait auth.register({\n  email: \"user@example.com\",\n  password: \"secure-password\",\n});\n\nawait auth.login({\n  email: \"user@example.com\",\n  password: \"secure-password\",\n});"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Swift:"
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "import EntityKit\n\nlet config = EntityAuthConfig(\n    environment: .production,\n    workspaceTenantId: \"your-tenant-id\",\n    clientIdentifier: \"ios-app\"\n)\nlet auth = EntityAuthFacade(config: config)\n\ntry await auth.register(request: .init(email: \"user@example.com\", password: \"secure-password\"))\ntry await auth.login(request: .init(email: \"user@example.com\", password: \"secure-password\"))"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "faq",
          "children": [
            {
              "type": "text",
              "value": "FAQ"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "next-steps",
          "children": [
            {
              "type": "text",
              "value": "Next Steps"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "link",
                          "url": "/docs/authentication",
                          "children": [
                            {
                              "type": "text",
                              "value": "Authentication"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Learn about login, tokens, and security"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "link",
                          "url": "/docs/organizations",
                          "children": [
                            {
                              "type": "text",
                              "value": "Organizations"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - Set up multi-tenant applications"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "link",
                          "url": "/docs/sdk-js",
                          "children": [
                            {
                              "type": "text",
                              "value": "Web SDK"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - JavaScript/TypeScript integration guide"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "link",
                          "url": "/docs/sdk-swift",
                          "children": [
                            {
                              "type": "text",
                              "value": "Swift SDK"
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " - iOS/macOS integration guide"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Quick Links",
        "id": "quick-links",
        "depth": 2,
        "children": []
      },
      {
        "title": "Installation",
        "id": "installation",
        "depth": 2,
        "children": []
      },
      {
        "title": "Getting Started",
        "id": "getting-started",
        "depth": 2,
        "children": [
          {
            "title": "Features",
            "id": "features",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Basic Usage",
        "id": "basic-usage",
        "depth": 2,
        "children": []
      },
      {
        "title": "FAQ",
        "id": "faq",
        "depth": 2,
        "children": []
      },
      {
        "title": "Next Steps",
        "id": "next-steps",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "integrations",
      "convex-react"
    ],
    "url": "/integrations/convex-react",
    "frontmatter": {
      "title": "Convex React Adapter (@entityauth/react-convex)",
      "description": "Live user profile hook for Convex apps integrated with Entity Auth"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "install",
          "children": [
            {
              "type": "text",
              "value": "Install"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "pnpm add @entityauth/react-convex @entityauth/react"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Peer deps:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "react >= 18"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "convex >= 1"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "@entityauth/react >= 0.0.1"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "usage",
          "children": [
            {
              "type": "text",
              "value": "Usage"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Create a typed hook bound to your Convex API."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// hooks/useUserProfile.ts\n\n\nexport const useUserProfile = createUseUserProfile(api);"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use it in your components. Make sure your app is wrapped with "
            },
            {
              "type": "inlineCode",
              "value": "EntityAuthProvider"
            },
            {
              "type": "text",
              "value": " from "
            },
            {
              "type": "inlineCode",
              "value": "@entityauth/react"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\nexport function ProfilePanel() {\n  const { me, user, oauthCredentials, hasPasswordCredential, isLoading } = useUserProfile();\n  if (isLoading) return <div>Loading…</div>;\n  return (\n    <pre>\n      {JSON.stringify({ me, user, oauthCredentials, hasPasswordCredential }, null, 2)}\n    </pre>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "what-it-returns",
          "children": [
            {
              "type": "text",
              "value": "What it returns"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "me"
                    },
                    {
                      "type": "text",
                      "value": ": The Entity Auth "
                    },
                    {
                      "type": "inlineCode",
                      "value": "me"
                    },
                    {
                      "type": "text",
                      "value": " payload (id, email, username, workspaceTenantId)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "user"
                    },
                    {
                      "type": "text",
                      "value": ": The Convex "
                    },
                    {
                      "type": "inlineCode",
                      "value": "auth.users.getById"
                    },
                    {
                      "type": "text",
                      "value": " result for the current user id (or "
                    },
                    {
                      "type": "inlineCode",
                      "value": "undefined"
                    },
                    {
                      "type": "text",
                      "value": " while loading)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "oauthCredentials"
                    },
                    {
                      "type": "text",
                      "value": ": List of linked OAuth credentials for the current user (if any)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "hasPasswordCredential"
                    },
                    {
                      "type": "text",
                      "value": ": "
                    },
                    {
                      "type": "inlineCode",
                      "value": "true"
                    },
                    {
                      "type": "text",
                      "value": " if a password credential exists, "
                    },
                    {
                      "type": "inlineCode",
                      "value": "false"
                    },
                    {
                      "type": "text",
                      "value": " if not, "
                    },
                    {
                      "type": "inlineCode",
                      "value": "null"
                    },
                    {
                      "type": "text",
                      "value": " if unknown."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "isLoading"
                    },
                    {
                      "type": "text",
                      "value": ": "
                    },
                    {
                      "type": "inlineCode",
                      "value": "true"
                    },
                    {
                      "type": "text",
                      "value": " while queries are pending with a valid user id."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "how-it-works",
          "children": [
            {
              "type": "text",
              "value": "How it works"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Internally, the adapter reads auth state from "
            },
            {
              "type": "inlineCode",
              "value": "@entityauth/react"
            },
            {
              "type": "text",
              "value": ", then issues Convex "
            },
            {
              "type": "inlineCode",
              "value": "useQuery"
            },
            {
              "type": "text",
              "value": " calls:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "api.auth.users.getById({ id })"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "api.entities.list({ workspaceTenantId, kind: 'credential', limit: 250 })"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "It derives the credential summary for convenient UI rendering."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "see-also",
          "children": [
            {
              "type": "text",
              "value": "See also"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "React SDK: "
                    },
                    {
                      "type": "link",
                      "url": "/docs/sdk-react",
                      "children": [
                        {
                          "type": "text",
                          "value": "/docs/sdk-react"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex OIDC basics: "
                    },
                    {
                      "type": "link",
                      "url": "/docs/integrations/convex",
                      "children": [
                        {
                          "type": "text",
                          "value": "/docs/integrations/convex"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Install",
        "id": "install",
        "depth": 2,
        "children": []
      },
      {
        "title": "Usage",
        "id": "usage",
        "depth": 2,
        "children": [
          {
            "title": "What it returns",
            "id": "what-it-returns",
            "depth": 3,
            "children": []
          },
          {
            "title": "How it works",
            "id": "how-it-works",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "See also",
        "id": "see-also",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "integrations",
      "convex"
    ],
    "url": "/integrations/convex",
    "frontmatter": {
      "title": "Convex Integration (OIDC)",
      "description": "Connect Entity Auth to Convex using OpenID Connect and map identities."
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 1,
          "id": "convex-integration-oidc",
          "children": [
            {
              "type": "text",
              "value": "Convex Integration (OIDC)"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "prerequisites",
          "children": [
            {
              "type": "text",
              "value": "Prerequisites"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Issuer (iss): "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://entity-auth.com"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "JWKS: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://entity-auth.com/.well-known/jwks.json"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Application ID (aud): "
                    },
                    {
                      "type": "inlineCode",
                      "value": "convex"
                    },
                    {
                      "type": "text",
                      "value": " (or your custom value)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "configure-convex",
          "children": [
            {
              "type": "text",
              "value": "Configure Convex"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "You can configure Convex in the dashboard (Authentication → OIDC) or in code."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// convex/auth.config.ts\n\nexport default defineAuth({\n  providers: [\n    {\n      type: \"oidc\",\n      issuerURL: \"https://entity-auth.com\",\n      jwksURL: \"https://entity-auth.com/.well-known/jwks.json\",\n      applicationID: \"convex\", // must match your JWT aud\n    },\n  ],\n});"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Deploy your Convex backend after adding this file."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "client-wiring-convexproviderwithauth",
          "children": [
            {
              "type": "text",
              "value": "Client wiring (ConvexProviderWithAuth)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Pass Entity Auth’s access token to Convex. Example hook:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\n\n\nfunction useAuthFromEntityAuth() {\n  const fetchAccessToken = useCallback(async ({ forceRefreshToken }: { forceRefreshToken: boolean }) => {\n    if (forceRefreshToken) await entityAuthClient.refresh();\n    return entityAuthClient.getAccessToken();\n  }, []);\n\n  return useMemo(\n    () => ({\n      isLoading: false,\n      isAuthenticated: Boolean(entityAuthClient.getAccessToken()),\n      fetchAccessToken,\n    }),\n    [fetchAccessToken]\n  );\n}\n\n// Usage at app root:\n// <ConvexProviderWithAuth client={convex} useAuth={useAuthFromEntityAuth}>...</ConvexProviderWithAuth>"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "react-hooks-integration",
          "children": [
            {
              "type": "text",
              "value": "React hooks integration"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If you want a higher-level hook that combines Entity Auth state with live Convex queries, see the Convex React adapter:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "link",
                      "url": "/docs/integrations/convex-react",
                      "children": [
                        {
                          "type": "text",
                          "value": "/docs/integrations/convex-react"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "identity-mapping-easub",
          "children": [
            {
              "type": "text",
              "value": "Identity mapping (eaSub)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If your JWT lacks an "
                    },
                    {
                      "type": "inlineCode",
                      "value": "email"
                    },
                    {
                      "type": "text",
                      "value": " claim, match users by subject ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "sub"
                    },
                    {
                      "type": "text",
                      "value": ")."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Store "
                    },
                    {
                      "type": "inlineCode",
                      "value": "eaSub = JWT.sub"
                    },
                    {
                      "type": "text",
                      "value": " on your user record the first time you see the identity."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Ensure backfill flows or guardrails link sessions via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "eaSub"
                    },
                    {
                      "type": "text",
                      "value": " when email is missing."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "troubleshooting",
          "children": [
            {
              "type": "text",
              "value": "Troubleshooting"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Decode a token in the browser console:"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "js",
          "code": "const payload = JSON.parse(atob(token.split(\".\")[1].replace(/-/g, \"+\").replace(/_/g, \"/\")));\nconsole.log(payload.iss, payload.aud, payload.sub);"
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Verify on Convex Dashboard → Authentication → Test token."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Common fixes:"
                    }
                  ]
                },
                {
                  "type": "list",
                  "ordered": false,
                  "children": [
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "text",
                              "value": "Issuer mismatch: Convex must use "
                            },
                            {
                              "type": "inlineCode",
                              "value": "https://entity-auth.com"
                            },
                            {
                              "type": "text",
                              "value": " (not a tenant subdomain)."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "text",
                              "value": "Audience mismatch: Convex "
                            },
                            {
                              "type": "inlineCode",
                              "value": "applicationID"
                            },
                            {
                              "type": "text",
                              "value": " must equal the token’s "
                            },
                            {
                              "type": "inlineCode",
                              "value": "aud"
                            },
                            {
                              "type": "text",
                              "value": "."
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "listItem",
                      "children": [
                        {
                          "type": "paragraph",
                          "children": [
                            {
                              "type": "text",
                              "value": "JWKS errors: "
                            },
                            {
                              "type": "inlineCode",
                              "value": "/.well-known/jwks.json"
                            },
                            {
                              "type": "text",
                              "value": " must return a key; set "
                            },
                            {
                              "type": "inlineCode",
                              "value": "EA_JWT_PUBLIC_KEY_PEM_B64"
                            },
                            {
                              "type": "text",
                              "value": " if needed."
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Convex Integration (OIDC)",
        "id": "convex-integration-oidc",
        "depth": 1,
        "children": [
          {
            "title": "Prerequisites",
            "id": "prerequisites",
            "depth": 2,
            "children": []
          },
          {
            "title": "Configure Convex",
            "id": "configure-convex",
            "depth": 2,
            "children": []
          },
          {
            "title": "Client wiring (ConvexProviderWithAuth)",
            "id": "client-wiring-convexproviderwithauth",
            "depth": 2,
            "children": [
              {
                "title": "React hooks integration",
                "id": "react-hooks-integration",
                "depth": 3,
                "children": []
              }
            ]
          },
          {
            "title": "Identity mapping (eaSub)",
            "id": "identity-mapping-easub",
            "depth": 2,
            "children": []
          },
          {
            "title": "Troubleshooting",
            "id": "troubleshooting",
            "depth": 2,
            "children": []
          }
        ]
      }
    ]
  },
  {
    "slug": [
      "openapi"
    ],
    "url": "/openapi",
    "frontmatter": {
      "title": "OpenAPI",
      "description": "Discoverable, versioned OpenAPI for Entity Auth"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth exposes a versioned OpenAPI spec at "
            },
            {
              "type": "inlineCode",
              "value": "/api/openapi"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "You can fetch it via the SDK:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst auth = new EntityAuthClient();\nconst spec = await auth.getOpenAPI();"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Schema version: 0.3.0."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Endpoints covered include authentication (register, login, refresh, logout), users, organizations, and sessions (current, list, revoke)."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use this to generate clients or validate requests."
            }
          ]
        }
      ]
    },
    "toc": []
  },
  {
    "slug": [
      "organizations"
    ],
    "url": "/organizations",
    "frontmatter": {
      "title": "Organizations",
      "description": "Create orgs, add members, and switch context"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Organizations provide multi‑tenant scoping. The SDKs expose thin wrappers over the API routes."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "create-generic-entities",
          "children": [
            {
              "type": "text",
              "value": "Create (generic entities)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={[\"Web\",\"Swift\"]}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\nconst me = await SDK.me();\nawait SDK.createEntity({\n  workspaceTenantId: me.workspaceTenantId!,\n  kind: 'org',\n  properties: { name: 'Acme', slug: 'acme', ownerId: me.id },\n});"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let config = EntityAuthConfig(\n    environment: .production,\n    workspaceTenantId: \"your-tenant-id\",\n    clientIdentifier: \"ios-app\"\n)\nlet auth = EntityAuthFacade(config: config)\n// Uses generic /api/entities under the hood\ntry await auth.createOrganization(name: \"Acme\", slug: \"acme\", ownerId: userId)"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "add-member-generic-relations",
          "children": [
            {
              "type": "text",
              "value": "Add member (generic relations)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={[\"Web\",\"Swift\"]}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\nconst me = await SDK.me();\nawait SDK.linkRelation({\n  workspaceTenantId: me.workspaceTenantId!,\n  srcId: userId, // user\n  relation: 'member_of',\n  dstId: orgId, // organization\n  attrs: { role: 'member' },\n});"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await auth.addMember(orgId: orgId, userId: userId, role: \"member\")"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "active-org-context",
          "children": [
            {
              "type": "text",
              "value": "Active org context"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Active organization is carried in the access token as "
            },
            {
              "type": "inlineCode",
              "value": "oid"
            },
            {
              "type": "text",
              "value": " (org id). Use the switch endpoint to change it and reissue a token."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "switch-organization",
          "children": [
            {
              "type": "text",
              "value": "Switch Organization"
            }
          ]
        },
        {
          "type": "code",
          "language": "http",
          "code": "POST /api/auth/switch-organization\nContent-Type: application/json\nAuthorization: Bearer <access-token>\n\n{ \"organizationId\": \"entities:org\" }"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Response:"
            }
          ]
        },
        {
          "type": "code",
          "language": "json",
          "code": "{ \"accessToken\": \"...\", \"organizationId\": \"entities:org\" }"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Notes:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "wid"
                    },
                    {
                      "type": "text",
                      "value": " (workspace tenant id) stays constant for the app."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    },
                    {
                      "type": "text",
                      "value": " (active org id) changes in the new access token."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Refresh token is not rotated here; clients keep their existing refresh token."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "swift",
          "children": [
            {
              "type": "text",
              "value": "Swift"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await facade.switchOrg(orgId: \"entities:org\")"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "web-js",
          "children": [
            {
              "type": "text",
              "value": "Web (JS)"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "await ea.fetch('/api/auth/switch-organization', {\n  method: 'POST',\n  body: JSON.stringify({ organizationId: 'entities:org' }),\n});"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "oidc-tokens",
          "children": [
            {
              "type": "text",
              "value": "OIDC & Tokens"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Issuer exposes "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/.well-known/openid-configuration"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/.well-known/jwks.json"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Access token claims: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "sub"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "wid"
                    },
                    {
                      "type": "text",
                      "value": " (app tenant id), "
                    },
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    },
                    {
                      "type": "text",
                      "value": " (active org id)."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "list-organizations",
          "children": [
            {
              "type": "text",
              "value": "List organizations"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use relations to find organizations for a user, then fetch each org entity:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\nconst me = await SDK.me();\nconst links = await SDK.queryRelations({ srcId: me.user.id, relation: 'member_of' });\nconst orgs = await Promise.all(\n  links.map(async (l) => SDK.getEntity({ id: l.dstId }))\n);"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "active-organization",
          "children": [
            {
              "type": "text",
              "value": "Active organization"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// ActiveOrganization extends OrganizationSummary with optional description\ntype ActiveOrganization = OrganizationSummary & {\n  description: string | null;\n};\n\nconst active: ActiveOrganization | null = await ea.getActiveOrganization();\nif (active) {\n  console.log(active.orgId, active.description);\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "invitations",
          "children": [
            {
              "type": "text",
              "value": "Invitations"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Invite users to organizations by email or username. Pending invites can be accepted, declined, or revoked. Acceptance creates a "
            },
            {
              "type": "inlineCode",
              "value": "member_of"
            },
            {
              "type": "text",
              "value": " relation and updates member counts."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={[\"Web\",\"Swift\"]}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// Search user (email or username)\nconst res = await fetch(\"/api/users/search\", {\n  method: \"POST\",\n  headers: { \"Content-Type\": \"application/json\" },\n  body: JSON.stringify({ email: \"user@example.com\" }), // or { username: \"alice\" }\n});\nconst user = await res.json(); // may be null if not found\n\n// Send invite (owner/admin of org)\nawait fetch(\"/api/invitations\", {\n  method: \"POST\",\n  headers: { \"Content-Type\": \"application/json\" },\n  body: JSON.stringify({\n    op: \"send\",\n    orgId: \"entities:org\",\n    inviteeId: user.id,\n    role: \"member\",\n  }),\n});\n\n// List received/sent\nawait fetch(`/api/invitations?userId=${me.id}`);\nawait fetch(`/api/invitations?inviterId=${me.id}`);\n\n// Accept / Decline / Revoke\nawait fetch(\"/api/invitations\", {\n  method: \"POST\",\n  headers: { \"Content-Type\": \"application/json\" },\n  body: JSON.stringify({ op: \"accept\", invitationId: \"entities:inv\" }),\n});"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let invitations = InvitationService(client: apiClient)\n// Search\nlet found = try await invitations.findUser(email: \"user@example.com\", username: nil)\n// Send (owner/admin)\ntry await invitations.send(orgId: \"entities:org\", inviteeId: found!.id, role: \"member\")\n// Lists\nlet received = try await invitations.listReceived(for: me.id)\nlet sent = try await invitations.listSent(by: me.id)\n// Accept\ntry await invitations.accept(invitationId: received.first!.id)"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "members-list-ui",
          "children": [
            {
              "type": "text",
              "value": "Members List UI"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use the ready-made components to view org members and manage membership."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={[\"Web\",\"Swift\"]}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\n<OrganizationMembers\n  client={ea}\n  orgId={activeOrgId}\n  currentUserId={me.id}\n  workspaceTenantId={me.workspaceTenantId!}\n/>;"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "import EntityAuthUI\n\nOrganizationMembersList(\n    orgId: activeOrgId,\n    canManage: activeRole == \"owner\" || activeRole == \"admin\",\n    currentUserId: me.id\n)"
        }
      ]
    },
    "toc": [
      {
        "title": "Create (generic entities)",
        "id": "create-generic-entities",
        "depth": 2,
        "children": []
      },
      {
        "title": "Add member (generic relations)",
        "id": "add-member-generic-relations",
        "depth": 2,
        "children": []
      },
      {
        "title": "Active org context",
        "id": "active-org-context",
        "depth": 2,
        "children": [
          {
            "title": "Switch Organization",
            "id": "switch-organization",
            "depth": 3,
            "children": []
          },
          {
            "title": "Swift",
            "id": "swift",
            "depth": 3,
            "children": []
          },
          {
            "title": "Web (JS)",
            "id": "web-js",
            "depth": 3,
            "children": []
          },
          {
            "title": "OIDC & Tokens",
            "id": "oidc-tokens",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "List organizations",
        "id": "list-organizations",
        "depth": 2,
        "children": []
      },
      {
        "title": "Active organization",
        "id": "active-organization",
        "depth": 2,
        "children": []
      },
      {
        "title": "Invitations",
        "id": "invitations",
        "depth": 2,
        "children": []
      },
      {
        "title": "Members List UI",
        "id": "members-list-ui",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "provisioning"
    ],
    "url": "/provisioning",
    "frontmatter": {
      "title": "Provisioning and Identity Linking",
      "description": "One centralized path for user, organization, and membership provisioning"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "overview",
          "children": [
            {
              "type": "text",
              "value": "Overview"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth now centralizes provisioning. After any successful sign-in (email/password, SSO, passkeys), the server runs a single idempotent mutation to ensure a personal organization exists and that the user has an owner membership."
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "User is resolved/created"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Org is ensured via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ensurePersonalOrgAndOwner"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Session stores "
                    },
                    {
                      "type": "inlineCode",
                      "value": "organizationId"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Access tokens include claims: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "wid"
                    },
                    {
                      "type": "text",
                      "value": " (tenant) and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    },
                    {
                      "type": "text",
                      "value": " (active organization)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "why-this-matters",
          "children": [
            {
              "type": "text",
              "value": "Why this matters"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "No duplication between apps and backend"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Deterministic behavior across identity methods"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Clients derive org context from "
                    },
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    },
                    {
                      "type": "text",
                      "value": "; no client-side provisioning required"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "what-changed",
          "children": [
            {
              "type": "text",
              "value": "What changed"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Removed workspace membership linking during auth"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Removed reliance on per-tenant "
                    },
                    {
                      "type": "inlineCode",
                      "value": "user_roles"
                    },
                    {
                      "type": "text",
                      "value": " for auth semantics"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Dashboard role displays derive from org memberships"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "client-guidance",
          "children": [
            {
              "type": "text",
              "value": "Client guidance"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Use access token "
                    },
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    },
                    {
                      "type": "text",
                      "value": " to pick the current organization"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If you need to switch organizations, call the switch endpoint to mint a new token with a different "
                    },
                    {
                      "type": "inlineCode",
                      "value": "oid"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Overview",
        "id": "overview",
        "depth": 2,
        "children": []
      },
      {
        "title": "Why this matters",
        "id": "why-this-matters",
        "depth": 2,
        "children": []
      },
      {
        "title": "What changed",
        "id": "what-changed",
        "depth": 2,
        "children": []
      },
      {
        "title": "Client guidance",
        "id": "client-guidance",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "quickstart"
    ],
    "url": "/quickstart",
    "frontmatter": {
      "title": "5‑Minute Quickstart",
      "description": "Set up Entity Auth in minutes for Web and Swift"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "This guide gets you from zero to authenticated in 5 minutes on Web and Swift. It includes exact steps and copy‑paste code blocks."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "web-typescriptjavascript",
          "children": [
            {
              "type": "text",
              "value": "Web (TypeScript/JavaScript)"
            }
          ]
        },
        {
          "type": "code",
          "code": "```bash\nnpm install @entityauth/auth-client\n```"
        },
        {
          "type": "code",
          "code": "```bash\n# copy from dashboard → Setup tab\nENTITY_AUTH_WORKSPACE_TENANT_ID=ws_prod_123\nNEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID=ws_prod_123\nNEXT_PUBLIC_ENTITY_AUTH_URL=https://ws_prod_123.entity-auth.com\n```"
        },
        {
          "type": "code",
          "code": "```ts\nimport { EntityAuthClient, init as initEA } from '@entityauth/auth-client';\n\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n```"
        },
        {
          "type": "code",
          "code": "```ts\nawait ea.register({ email: 'user@example.com', password: 'password123' });\n\nconst { accessToken, userId, sessionId } = await ea.login({\n  email: 'user@example.com',\n  password: 'password123',\n});\n```"
        },
        {
          "type": "code",
          "code": "```ts\nconst res = await ea.fetch('/api/user/me', { method: 'GET' });\nconst me = await res.json();\nconsole.log(me);\n```"
        },
        {
          "type": "code",
          "code": "```ts\nimport { SDK } from '@entityauth/auth-client';\n\n// Create org via generic entities\nconst me = await SDK.me();\nconst org = await SDK.createEntity({\n  workspaceTenantId: me.workspaceTenantId!,\n  kind: 'org',\n  properties: { name: 'Acme', slug: 'acme', ownerId: me.id }\n});\n\n// Link membership via generic relations\nawait SDK.linkRelation({\n  workspaceTenantId: me.workspaceTenantId!,\n  srcId: me.id,\n  relation: 'member_of',\n  dstId: org.id,\n  attrs: { role: 'owner' }\n});\n```"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "swift-iosmacos",
          "children": [
            {
              "type": "text",
              "value": "Swift (iOS/macOS)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Remove the official "
                    },
                    {
                      "type": "inlineCode",
                      "value": "get-convex/convex-swift"
                    },
                    {
                      "type": "text",
                      "value": " from your Package.swift dependencies"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Replace it with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://github.com/entityauth/convex-swift.git"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Add EntityKit (which will use the forked convex-swift transitively)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "This fork includes Entity Auth-specific realtime features. Xcode will show a package identity conflict error if both versions are present.\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "code": "In Package.swift:\n```swift\n.package(url: \"https://github.com/entityauth/EntityKit.git\", from: \"1.0.0\")\n```"
        },
        {
          "type": "code",
          "code": "```swift\nimport EntityKit\nlet facade = EntityAuthFacade(\n    config: EntityAuthConfig(\n        environment: .production,\n        workspaceTenantId: \"YOUR_TENANT_ID\"\n    )\n)\n```"
        },
        {
          "type": "code",
          "code": "```swift\ntry await facade.register(request: RegisterRequest(\n    email: \"user@example.com\",\n    password: \"password123\",\n    workspaceTenantId: \"YOUR_TENANT_ID\"\n))\n\ntry await facade.login(request: LoginRequest(\n    email: \"user@example.com\",\n    password: \"password123\",\n    workspaceTenantId: \"YOUR_TENANT_ID\"\n))\n\nlet snapshot = facade.currentSnapshot()\nprint(snapshot.userId ?? \"anonymous\")\n```"
        },
        {
          "type": "code",
          "code": "```swift\nstruct Me: Decodable { let id: String; let email: String? }\nlet result: Me = try await facade.fetchGraphQL(\n    query: \"\"\"\n    query Viewer { me { id email } }\n    \"\"\",\n    variables: nil\n)\n```"
        },
        {
          "type": "code",
          "code": "```swift\nlet orgs = try await facade.organizations()\nif let first = orgs.first {\n    try await facade.switchOrg(orgId: first.orgId)\n}\n```"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "next-steps",
          "children": [
            {
              "type": "text",
              "value": "Next steps"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Explore API via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ea.getOpenAPI()"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Web (TypeScript/JavaScript)",
        "id": "web-typescriptjavascript",
        "depth": 2,
        "children": []
      },
      {
        "title": "Swift (iOS/macOS)",
        "id": "swift-iosmacos",
        "depth": 2,
        "children": []
      },
      {
        "title": "Next steps",
        "id": "next-steps",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "replicator",
      "architecture"
    ],
    "url": "/replicator/architecture",
    "frontmatter": {
      "title": "Real-time Bridge Architecture",
      "description": "Understand the left/middle/right bridge spans and the event contracts that power the replicator."
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 1,
          "id": "real-time-bridge-architecture",
          "children": [
            {
              "type": "text",
              "value": "Real-time Bridge Architecture"
            }
          ]
        },
        {
          "type": "code",
          "code": "┌─────────────────────┐        websocket feed        ┌─────────────────────┐\n│  Left Bridge        │   (Convex subscription +     │  Right Bridge       │\n│  Entity Auth Core   │────── versioned events ─────▶│  Customer Replicator│\n│  (Convex mutations) │                              │  + Local DB Adapter  │\n└─────────────────────┘◀──── applyExternalMutation ──└─────────────────────┘\n               ▲                                          │\n               │                                          ▼\n        Convex actions / queries                 Customer application + DB"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "data-flows",
          "children": [
            {
              "type": "text",
              "value": "Data flows"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "outbound-entity-auth-customer-db",
          "children": [
            {
              "type": "text",
              "value": "Outbound (Entity Auth → Customer DB)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex mutation writes canonical data and calls "
                    },
                    {
                      "type": "inlineCode",
                      "value": "appendWorkspaceEvent"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Event stored in "
                    },
                    {
                      "type": "inlineCode",
                      "value": "workspace_events"
                    },
                    {
                      "type": "text",
                      "value": " with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ workspaceTenantId, version, payload }"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Replicator fetches ordered events via websocket subscription."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Adapter applies event inside customer DB and advances the cursor."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "inbound-customer-db-entity-auth",
          "children": [
            {
              "type": "text",
              "value": "Inbound (Customer DB → Entity Auth)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Local change triggers call to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "applyExternalMutation"
                    },
                    {
                      "type": "text",
                      "value": " with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ eventType, payload, dedupeKey }"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex action authenticates, validates, and invokes the canonical mutation."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Mutation emits the same event path; all replicas observe convergence."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "event-envelope",
          "children": [
            {
              "type": "text",
              "value": "Event envelope"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "export type WorkspaceEvent = {\n  workspaceTenantId: string;\n  version: number;\n  entityKind: string;\n  entityId: string;\n  eventType: string;\n  payload: Json;\n  source: {\n    mutation: string;\n    actorId: string | null;\n    origin: \"entity-auth\" | \"customer-replicator\";\n  };\n  emittedAt: number;\n  traceId?: string;\n  schemaVersion?: number;\n};"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Payload schemas live in "
            },
            {
              "type": "inlineCode",
              "value": "docs/internal/workspace-events.md"
            },
            {
              "type": "text",
              "value": " and are mirrored inside the replicator adapters."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "guarantees",
          "children": [
            {
              "type": "text",
              "value": "Guarantees"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Ordering"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": lamport-style "
                    },
                    {
                      "type": "inlineCode",
                      "value": "version"
                    },
                    {
                      "type": "text",
                      "value": " per workspace; resume via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "afterVersion"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Idempotency"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": adapters upsert/delete with version checks."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Replay"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": offset store persists last version and supports catch-up."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Conflict resolution"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Entity Auth stays authoritative; inbound mutations reuse canonical validation."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "replicator-runtime-internals",
          "children": [
            {
              "type": "text",
              "value": "Replicator runtime internals"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "runBridge(options)"
                    },
                    {
                      "type": "text",
                      "value": " orchestrates subscription polling, adapter application, and cursor updates."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "adapters/"
                    },
                    {
                      "type": "text",
                      "value": " directory exposes helpers like "
                    },
                    {
                      "type": "inlineCode",
                      "value": "createPrismaAdapter()"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "memoryAdapter()"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "storage/sqlite.ts"
                    },
                    {
                      "type": "text",
                      "value": " persists offsets by default; implement custom stores as needed."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Lifecycle hooks ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "onEvent"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onBatchProcessed"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onHeartbeat"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onExit"
                    },
                    {
                      "type": "text",
                      "value": ") provide monitoring points."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "deployment-shapes",
          "children": [
            {
              "type": "text",
              "value": "Deployment shapes"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Long-running worker"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": run "
                    },
                    {
                      "type": "inlineCode",
                      "value": "node runner.mjs"
                    },
                    {
                      "type": "text",
                      "value": " under system supervisors."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Serverless batch"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": instantiate "
                    },
                    {
                      "type": "inlineCode",
                      "value": "runBridge"
                    },
                    {
                      "type": "text",
                      "value": " with custom "
                    },
                    {
                      "type": "inlineCode",
                      "value": "waitFn"
                    },
                    {
                      "type": "text",
                      "value": " for single-use batch jobs."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Edge/adapter-specific"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": tune "
                    },
                    {
                      "type": "inlineCode",
                      "value": "eventsPerBatch"
                    },
                    {
                      "type": "text",
                      "value": " and handler logic to match latency requirements."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "See the playbooks for concrete integrations."
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Real-time Bridge Architecture",
        "id": "real-time-bridge-architecture",
        "depth": 1,
        "children": [
          {
            "title": "Data flows",
            "id": "data-flows",
            "depth": 2,
            "children": [
              {
                "title": "Outbound (Entity Auth → Customer DB)",
                "id": "outbound-entity-auth-customer-db",
                "depth": 3,
                "children": []
              },
              {
                "title": "Inbound (Customer DB → Entity Auth)",
                "id": "inbound-customer-db-entity-auth",
                "depth": 3,
                "children": []
              }
            ]
          },
          {
            "title": "Event envelope",
            "id": "event-envelope",
            "depth": 2,
            "children": []
          },
          {
            "title": "Guarantees",
            "id": "guarantees",
            "depth": 2,
            "children": []
          },
          {
            "title": "Replicator runtime internals",
            "id": "replicator-runtime-internals",
            "depth": 2,
            "children": []
          },
          {
            "title": "Deployment shapes",
            "id": "deployment-shapes",
            "depth": 2,
            "children": []
          }
        ]
      }
    ]
  },
  {
    "slug": [
      "replicator"
    ],
    "url": "/replicator",
    "frontmatter": {
      "title": "Replicator Overview",
      "description": "Bootstrap, run, and monitor the real-time bridge powered by the replicator runtime."
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 1,
          "id": "replicator-overview",
          "children": [
            {
              "type": "text",
              "value": "Replicator Overview"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "why-we-ship-the-bridge",
          "children": [
            {
              "type": "text",
              "value": "Why we ship the bridge"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Mirror Entity Auth’s canonical state into a customer database in real time."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Replay events and publish local mutations back upstream with idempotent guarantees."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Keep humans and LLM agents on the same surface area via the Entity CLI engine."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "what-ships-in-the-pack",
          "children": [
            {
              "type": "text",
              "value": "What ships in the pack"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge/nodes.json"
                    },
                    {
                      "type": "text",
                      "value": " registers template nodes ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "entityauth:bridge:postgres-prisma"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "entityauth:bridge:memory-demo"
                    },
                    {
                      "type": "text",
                      "value": ")."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Each template includes a runner, config skeleton, adapter wiring, and documentation."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "The Bridge executor copies templates into your workspace, persists runtime state, and exposes "
                    },
                    {
                      "type": "inlineCode",
                      "value": "scaffold/start/status/stop"
                    },
                    {
                      "type": "text",
                      "value": " commands."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "quick-start-postgres-prisma",
          "children": [
            {
              "type": "text",
              "value": "Quick start (Postgres + Prisma)"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "npx @entityauth/cli bridge scaffold entity-auth --node entityauth:bridge:postgres-prisma\ncd entity-auth/templates/postgres-prisma\nnpm install\nnpx prisma generate\ncp replicator.config.json replicator.config.local.json\nnpx @entityauth/cli bridge start entity-auth --node entityauth:bridge:postgres-prisma\nnpx @entityauth/cli bridge status entity-auth --node entityauth:bridge:postgres-prisma"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "configuration-fields",
          "children": [
            {
              "type": "text",
              "value": "Configuration fields"
            }
          ]
        },
        {
          "type": "table",
          "align": [
            null,
            null
          ],
          "children": [
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Key"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Description"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "convexUrl"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex deployment URL for your workspace"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "workspaceTenantId"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Workspace tenant identifier"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "cursorId"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Unique identifier per consumer"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "authToken"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Replicator/workspace API token"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "eventsPerBatch"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Max events pulled per request (default 100)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "retry"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Backoff settings for subscription polling"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "applyExternalMutationAction"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex action path for inbound mutations"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "runtime-commands",
          "children": [
            {
              "type": "text",
              "value": "Runtime commands"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge scaffold"
                    },
                    {
                      "type": "text",
                      "value": " – Copy template into workspace"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge start"
                    },
                    {
                      "type": "text",
                      "value": " – Generate process descriptor + persist state"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge status"
                    },
                    {
                      "type": "text",
                      "value": " – Inspect latest state file"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge stop"
                    },
                    {
                      "type": "text",
                      "value": " – Mark state as stopped"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "using-",
          "children": [
            {
              "type": "text",
              "value": "Using "
            },
            {
              "type": "inlineCode",
              "value": "runBridge"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\nawait runBridge({\n  options: {\n    convexUrl: process.env.CONVEX_URL!,\n    workspaceTenantId: process.env.WORKSPACE_TENANT_ID!,\n    cursorId: \"postgres-prisma\",\n    authToken: process.env.CONVEX_REPLICATOR_TOKEN,\n    adapter: createPrismaAdapter({ prisma, handlers }),\n  },\n  logPath: \"./logs/replicator.log\",\n  name: \"postgres-prisma\",\n});"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "operational-best-practices",
          "children": [
            {
              "type": "text",
              "value": "Operational best practices"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Persist the offset store ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "replicator-offsets.db"
                    },
                    {
                      "type": "text",
                      "value": ") across restarts."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Use lifecycle hooks ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "onEvent"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onBatchProcessed"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onHeartbeat"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onExit"
                    },
                    {
                      "type": "text",
                      "value": ") for monitoring."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Provide "
                    },
                    {
                      "type": "inlineCode",
                      "value": "applyExternalMutationAction"
                    },
                    {
                      "type": "text",
                      "value": " to push local changes upstream."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Clean up "
                    },
                    {
                      "type": "inlineCode",
                      "value": ".entitycli/bridge/state/*.json"
                    },
                    {
                      "type": "text",
                      "value": " when decomissioning a workspace."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Replicator Overview",
        "id": "replicator-overview",
        "depth": 1,
        "children": [
          {
            "title": "Why we ship the bridge",
            "id": "why-we-ship-the-bridge",
            "depth": 2,
            "children": []
          },
          {
            "title": "What ships in the pack",
            "id": "what-ships-in-the-pack",
            "depth": 2,
            "children": []
          },
          {
            "title": "Quick start (Postgres + Prisma)",
            "id": "quick-start-postgres-prisma",
            "depth": 2,
            "children": []
          },
          {
            "title": "Configuration fields",
            "id": "configuration-fields",
            "depth": 2,
            "children": []
          },
          {
            "title": "Runtime commands",
            "id": "runtime-commands",
            "depth": 2,
            "children": []
          },
          {
            "title": "Using ",
            "id": "using-",
            "depth": 2,
            "children": []
          },
          {
            "title": "Operational best practices",
            "id": "operational-best-practices",
            "depth": 2,
            "children": []
          }
        ]
      }
    ]
  },
  {
    "slug": [
      "replicator",
      "operations"
    ],
    "url": "/replicator/operations",
    "frontmatter": {
      "title": "Replicator Operations",
      "description": "Security, monitoring, and recovery guidance for the bridge runtime."
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 1,
          "id": "replicator-operations",
          "children": [
            {
              "type": "text",
              "value": "Replicator Operations"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "security-checklist",
          "children": [
            {
              "type": "text",
              "value": "Security checklist"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Scope "
                    },
                    {
                      "type": "inlineCode",
                      "value": "CONVEX_REPLICATOR_TOKEN"
                    },
                    {
                      "type": "text",
                      "value": " to the workspace and rotate regularly."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Protect "
                    },
                    {
                      "type": "inlineCode",
                      "value": "replicator.config.json"
                    },
                    {
                      "type": "text",
                      "value": " and state files; they contain secrets."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Route inbound mutations through the provided helpers to reuse canonical validation."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Enforce rate limits on "
                    },
                    {
                      "type": "inlineCode",
                      "value": "applyExternalMutation"
                    },
                    {
                      "type": "text",
                      "value": " (baseline 100 writes/minute with burst allowance)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Keep transport encrypted end-to-end (Convex HTTPS/WSS)."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "monitoring-hooks",
          "children": [
            {
              "type": "text",
              "value": "Monitoring hooks"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Subscribe to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "onHeartbeat"
                    },
                    {
                      "type": "text",
                      "value": " for lag and status metrics."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Stream structured logs via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "logPath"
                    },
                    {
                      "type": "text",
                      "value": " into your logging stack."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Watch "
                    },
                    {
                      "type": "inlineCode",
                      "value": ".entitycli/bridge/state/<node>.json"
                    },
                    {
                      "type": "text",
                      "value": " for heartbeat timestamps and PID updates."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Alert on heartbeat staleness (>60 seconds) or growing lag between processed and latest versions."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "failure-recovery",
          "children": [
            {
              "type": "text",
              "value": "Failure recovery"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Restart crashes using the persisted state; offsets resume automatically."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Implement retry/backoff within adapters; halt on irrecoverable errors to avoid data divergence."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "On Convex action rejection, revert local state to the last confirmed version and surface the error."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "For large backlogs, reduce "
                    },
                    {
                      "type": "inlineCode",
                      "value": "eventsPerBatch"
                    },
                    {
                      "type": "text",
                      "value": " or run parallel replicas; events support replay from any version."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "maintenance",
          "children": [
            {
              "type": "text",
              "value": "Maintenance"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Snapshot local databases periodically; the event log can rebuild from version 0."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Purge "
                    },
                    {
                      "type": "inlineCode",
                      "value": ".entitycli/bridge/state"
                    },
                    {
                      "type": "text",
                      "value": " entries when decommissioning workspaces."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Stay current with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "@entityauth/replicator"
                    },
                    {
                      "type": "text",
                      "value": " releases to pick up adapter fixes."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Run "
                    },
                    {
                      "type": "inlineCode",
                      "value": "pnpm build:packs"
                    },
                    {
                      "type": "text",
                      "value": " before publishing CLI shims to bundle the latest templates."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "troubleshooting",
          "children": [
            {
              "type": "text",
              "value": "Troubleshooting"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "bridge status"
                    },
                    {
                      "type": "text",
                      "value": " reveals entry path, env, heartbeat, and logs path."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Use the memory demo template to validate connectivity without touching production."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "LOG_LEVEL=debug"
                    },
                    {
                      "type": "text",
                      "value": " (template support) for verbose processing traces."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "If cursors stall, inspect the offset store and file permissions."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Replicator Operations",
        "id": "replicator-operations",
        "depth": 1,
        "children": [
          {
            "title": "Security checklist",
            "id": "security-checklist",
            "depth": 2,
            "children": []
          },
          {
            "title": "Monitoring hooks",
            "id": "monitoring-hooks",
            "depth": 2,
            "children": []
          },
          {
            "title": "Failure recovery",
            "id": "failure-recovery",
            "depth": 2,
            "children": []
          },
          {
            "title": "Maintenance",
            "id": "maintenance",
            "depth": 2,
            "children": []
          },
          {
            "title": "Troubleshooting",
            "id": "troubleshooting",
            "depth": 2,
            "children": []
          }
        ]
      }
    ]
  },
  {
    "slug": [
      "replicator",
      "playbooks"
    ],
    "url": "/replicator/playbooks",
    "frontmatter": {
      "title": "Replicator Playbooks",
      "description": "Step-by-step guides for deploying the real-time bridge across environments."
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 1,
          "id": "replicator-playbooks",
          "children": [
            {
              "type": "text",
              "value": "Replicator Playbooks"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "nextjs-real-time-ui",
          "children": [
            {
              "type": "text",
              "value": "Next.js real-time UI"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Scaffold template:"
                    }
                  ]
                },
                {
                  "type": "code",
                  "language": "bash",
                  "code": "npx @entityauth/cli bridge scaffold entity-auth --node entityauth:bridge:postgres-prisma"
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Install dependencies & generate Prisma client:"
                    }
                  ]
                },
                {
                  "type": "code",
                  "language": "bash",
                  "code": "cd entity-auth/templates/postgres-prisma\nnpm install\nnpx prisma generate"
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Configure environment variables ("
                    },
                    {
                      "type": "inlineCode",
                      "value": ".env.local"
                    },
                    {
                      "type": "text",
                      "value": "):"
                    }
                  ]
                },
                {
                  "type": "code",
                  "code": "CONVEX_URL=https://<deployment>.convex.cloud\nWORKSPACE_TENANT_ID=workspace_123\nCONVEX_REPLICATOR_TOKEN=ct_...\nDATABASE_URL=postgresql://..."
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Start the bridge:"
                    }
                  ]
                },
                {
                  "type": "code",
                  "language": "bash",
                  "code": "npx @entityauth/cli bridge start entity-auth --node entityauth:bridge:postgres-prisma"
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Run your Next.js app ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "npm run dev"
                    },
                    {
                      "type": "text",
                      "value": ") using the synchronized database."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Monitor health with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "bridge status"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Publish local mutations via the template’s "
                    },
                    {
                      "type": "inlineCode",
                      "value": "publishExternalMutation"
                    },
                    {
                      "type": "text",
                      "value": " helper."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "background-worker-node",
          "children": [
            {
              "type": "text",
              "value": "Background worker (Node)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Scaffold or compose your own project using "
                    },
                    {
                      "type": "inlineCode",
                      "value": "@entityauth/replicator"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Ensure persistent storage for offsets (SQLite file, Redis, etc.)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Deploy under "
                    },
                    {
                      "type": "inlineCode",
                      "value": "systemd"
                    },
                    {
                      "type": "text",
                      "value": ", PM2, or containers; call "
                    },
                    {
                      "type": "inlineCode",
                      "value": "stop()"
                    },
                    {
                      "type": "text",
                      "value": " on shutdown."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Automate health reporting with periodic "
                    },
                    {
                      "type": "inlineCode",
                      "value": "bridge heartbeat"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "serverless-batch-cron",
          "children": [
            {
              "type": "text",
              "value": "Serverless batch (cron)"
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Create a handler that runs "
                    },
                    {
                      "type": "inlineCode",
                      "value": "runBridge"
                    },
                    {
                      "type": "text",
                      "value": " once with a custom "
                    },
                    {
                      "type": "inlineCode",
                      "value": "waitFn"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Schedule the job (Cloudflare Cron, AWS EventBridge, etc.)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Persist offsets in a durable store (Cloudflare DO, Redis, etc.)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "On each invocation, resume from the stored cursor and exit cleanly."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "memory-demo",
          "children": [
            {
              "type": "text",
              "value": "Memory demo"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use for quick validation or integration tests:"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "npx @entityauth/cli bridge scaffold entity-auth --node entityauth:bridge:memory-demo\nnpx @entityauth/cli bridge start entity-auth --node entityauth:bridge:memory-demo"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "common-knobs",
          "children": [
            {
              "type": "text",
              "value": "Common knobs"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "eventsPerBatch"
                    },
                    {
                      "type": "text",
                      "value": " – balance throughput vs latency."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "retry"
                    },
                    {
                      "type": "text",
                      "value": " – tune exponential backoff behaviour."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "applyExternalMutationAction"
                    },
                    {
                      "type": "text",
                      "value": " – enable bi-directional sync."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "logPath"
                    },
                    {
                      "type": "text",
                      "value": " – send structured logs to your platform."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Consult the operations guide for security and monitoring."
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Replicator Playbooks",
        "id": "replicator-playbooks",
        "depth": 1,
        "children": [
          {
            "title": "Next.js real-time UI",
            "id": "nextjs-real-time-ui",
            "depth": 2,
            "children": []
          },
          {
            "title": "Background worker (Node)",
            "id": "background-worker-node",
            "depth": 2,
            "children": []
          },
          {
            "title": "Serverless batch (cron)",
            "id": "serverless-batch-cron",
            "depth": 2,
            "children": []
          },
          {
            "title": "Memory demo",
            "id": "memory-demo",
            "depth": 2,
            "children": []
          },
          {
            "title": "Common knobs",
            "id": "common-knobs",
            "depth": 2,
            "children": []
          }
        ]
      }
    ]
  },
  {
    "slug": [
      "sdk-js"
    ],
    "url": "/sdk-js",
    "frontmatter": {
      "title": "SDK (Web)",
      "description": "EntityAuthClient methods and usage"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "user-roles",
          "children": [
            {
              "type": "text",
              "value": "User roles"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Read per-tenant roles for users via HTTP endpoints exposed by the dashboard app."
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "GET "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/user/roles?id=<userId>&workspaceTenantId=<tenant>"
                    },
                    {
                      "type": "text",
                      "value": " → "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ roles: string[] }"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "GET "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/api/users/roles?workspaceTenantId=<tenant>&ids=<id1,id2,...>"
                    },
                    {
                      "type": "text",
                      "value": " → "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ rolesByUserId: Record<string,string[]> }"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Example:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "const res = await fetch(\n  `/api/user/roles?workspaceTenantId=${tenantId}&id=${userId}`,\n  { headers: { Authorization: `Bearer ${accessToken}` } }\n);\nconst { roles } = await res.json();"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Initialize once, then construct with optional "
            },
            {
              "type": "inlineCode",
              "value": "{ baseURL }"
            },
            {
              "type": "text",
              "value": ". All methods mirror "
            },
            {
              "type": "inlineCode",
              "value": "/api/*"
            },
            {
              "type": "text",
              "value": " routes and reuse the tenant ID set during "
            },
            {
              "type": "inlineCode",
              "value": "init()"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "auth",
          "children": [
            {
              "type": "text",
              "value": "Auth"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "register({ email, password, defaultWorkspaceRole? })"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "login({ email, password })"
                    },
                    {
                      "type": "text",
                      "value": " → sets access token and returns "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ userId, sessionId }"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "refresh(headerRefreshToken?)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "logout()"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient({ baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL });\n\n// Make the first user an owner in this workspace\nawait ea.register({\n  email: 'first@acme.com',\n  password: 'super-secure',\n  defaultWorkspaceRole: 'owner',\n});"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If omitted, the user is created without a workspace owner/admin role; they can still sign in, but organization creation will be forbidden by policy.\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "generic-model-helpers",
          "children": [
            {
              "type": "text",
              "value": "Generic model helpers"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Prefer the exported "
                    },
                    {
                      "type": "inlineCode",
                      "value": "SDK"
                    },
                    {
                      "type": "text",
                      "value": " helpers for entities and relations."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Active organization is derived from "
                    },
                    {
                      "type": "inlineCode",
                      "value": "me().workspaceTenantId"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "\nconst me = await SDK.me();\nconst org = await SDK.createEntity({\n  workspaceTenantId: me.workspaceTenantId!,\n  kind: 'org',\n  properties: { name: 'Acme', slug: 'acme', ownerId: me.id },\n});\n\nawait SDK.linkRelation({\n  workspaceTenantId: me.workspaceTenantId!,\n  srcId: me.id,\n  relation: 'member_of',\n  dstId: org.id,\n  attrs: { role: 'owner' },\n});"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "users",
          "children": [
            {
              "type": "text",
              "value": "Users"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "me()"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Update properties via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "SDK.updateEntity"
                    },
                    {
                      "type": "text",
                      "value": ":"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "await SDK.updateEntityEnforced({ id: userId, patch: { properties: { username: 'newusername' } }, actorId: userId });\n\n// Universal list & upsert\nconst list = await SDK.listEntities({ workspaceTenantId: me.workspaceTenantId!, kind: 'user', filter: { status: 'active' }, limit: 25 });\nawait SDK.upsertEntity({ workspaceTenantId: me.workspaceTenantId!, kind: 'user', properties: { email: 'a@b.com' } });"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "sessions",
          "children": [
            {
              "type": "text",
              "value": "Sessions"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Managed server-side; use login/refresh/logout. No public list/revoke JS APIs."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "helpers",
          "children": [
            {
              "type": "text",
              "value": "Helpers"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "onTokenChange(listener)"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "getAccessToken()"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "getOpenAPI()"
                    },
                    {
                      "type": "text",
                      "value": " to inspect the server schema"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "getConvexConfig()"
                    },
                    {
                      "type": "text",
                      "value": " to read the Convex deployment URL"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "applyAccessToken(token)"
                    },
                    {
                      "type": "text",
                      "value": " for external auth handoffs"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "SDK.refresh(headerRefreshToken?)"
                    },
                    {
                      "type": "text",
                      "value": " for token maintenance without the class instance"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "allowed-origins-cross-origin",
          "children": [
            {
              "type": "text",
              "value": "Allowed origins & cross-origin"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Localhost origins ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "http://localhost:3000"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "3001"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "5173"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "4200"
                    },
                    {
                      "type": "text",
                      "value": ") are pre-seeded for every workspace"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Add production domains in the dashboard → Setup → Allowed Origins before deploying"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "The middleware sets "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Access-Control-Allow-Origin"
                    },
                    {
                      "type": "text",
                      "value": " dynamically per workspace and supports "
                    },
                    {
                      "type": "inlineCode",
                      "value": "credentials: 'include'"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "openapi-graphql",
          "children": [
            {
              "type": "text",
              "value": "OpenAPI & GraphQL"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "const openapi = await ea.getOpenAPI();\nconst result = await ea.graphql<{ me: { id: string; email: string | null } }>(\n  `query { me { id email } }`\n);\n\nif (\"errors\" in result) {\n  console.error(result.errors);\n} else {\n  console.log(result.data.me);\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "best-practices",
          "children": [
            {
              "type": "text",
              "value": "Best practices"
            }
          ]
        },
        {
          "type": "code",
          "code": "Always use `EntityAuthClient.fetch` for authenticated requests to automatically handle token refresh on 401 responses.\n\n```ts\n// Good: Auto-refreshes on 401\nconst response = await ea.fetch('/api/protected-endpoint');\n\n// Avoid: Manual fetch without auto-refresh\nfetch('/api/protected-endpoint', {\n  headers: { Authorization: `Bearer ${token}` }\n});\n```"
        },
        {
          "type": "code",
          "code": "The SDK automatically attempts a refresh once before the first authenticated request if no access token is present (using the `ea_refresh` cookie). This avoids an initial 401/auto-retry on page reloads."
        },
        {
          "type": "code",
          "code": "Listen for token updates to synchronize authentication state across your application.\n\n```ts\nea.onTokenChange((newToken) => {\n  if (newToken) {\n    console.log('User authenticated');\n  } else {\n    console.log('User logged out');\n  }\n});\n```"
        },
        {
          "type": "code",
          "code": "Never store access tokens in localStorage or sessionStorage. The SDK manages tokens in memory for security."
        },
        {
          "type": "code",
          "code": "Perform refresh on the server using the `ea_refresh` cookie so protected pages don't appear logged out after a hard reload. Guard routes with middleware and/or refresh in server layouts. See [Framework Integration](/docs/frameworks)."
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// middleware.ts\n\n\nexport function middleware(request: NextRequest) {\n  const refresh = request.cookies.get('ea_refresh');\n  if (!refresh && request.nextUrl.pathname.startsWith('/dashboard')) {\n    return NextResponse.redirect(new URL('/login', request.url));\n  }\n  return NextResponse.next();\n}\n\nexport const config = { matcher: ['/dashboard/:path*'] };"
        }
      ]
    },
    "toc": [
      {
        "title": "User roles",
        "id": "user-roles",
        "depth": 2,
        "children": []
      },
      {
        "title": "Auth",
        "id": "auth",
        "depth": 2,
        "children": []
      },
      {
        "title": "Generic model helpers",
        "id": "generic-model-helpers",
        "depth": 2,
        "children": []
      },
      {
        "title": "Users",
        "id": "users",
        "depth": 2,
        "children": []
      },
      {
        "title": "Sessions",
        "id": "sessions",
        "depth": 2,
        "children": []
      },
      {
        "title": "Helpers",
        "id": "helpers",
        "depth": 2,
        "children": [
          {
            "title": "Allowed origins & cross-origin",
            "id": "allowed-origins-cross-origin",
            "depth": 3,
            "children": []
          },
          {
            "title": "OpenAPI & GraphQL",
            "id": "openapi-graphql",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Best practices",
        "id": "best-practices",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "sdk-react"
    ],
    "url": "/sdk-react",
    "frontmatter": {
      "title": "React SDK (@entityauth/react)",
      "description": "Provider and hooks for Entity Auth in React apps"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "install",
          "children": [
            {
              "type": "text",
              "value": "Install"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "pnpm add @entityauth/react @entityauth/auth-client"
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// entity-auth/facade.ts\n\nexport const entityAuthFacade = createEntityAuthFacade({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n  initialSnapshot: { isLoadingUser: true },\n});"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "usage",
          "children": [
            {
              "type": "text",
              "value": "Usage"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Wrap your app with the provider and use the hooks anywhere in your component tree."
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "// app/layout.tsx (Next.js App Router) or App root in CRA/Vite\n\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <EntityAuthProvider facade={entityAuthFacade}>\n          {children}\n        </EntityAuthProvider>\n      </body>\n    </html>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "access-auth-state-and-user",
          "children": [
            {
              "type": "text",
              "value": "Access auth state and user"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\nexport function Example() {\n  const { isAuthenticated, loading, login, logout } = useEntityAuth();\n  const { me } = useMe<{ id: string; email: string | null }>();\n\n  if (loading) return <div>Loading…</div>;\n  return (\n    <div>\n      <div>Signed in: {String(isAuthenticated)}</div>\n      <pre>{JSON.stringify(me, null, 2)}</pre>\n      <button onClick={() => login({ email: 'a@b.com', password: 'secret' })}>Login</button>\n      <button onClick={() => logout()}>Logout</button>\n    </div>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "user-profile-helpers",
          "children": [
            {
              "type": "text",
              "value": "User profile helpers"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\nexport function Profile() {\n  const { me, oauthCredentials, hasPasswordCredential, isLoading } = useUserProfile();\n  if (isLoading) return <div>Loading…</div>;\n  return (\n    <pre>{JSON.stringify({ me, oauthCredentials, hasPasswordCredential }, null, 2)}</pre>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "api",
          "children": [
            {
              "type": "text",
              "value": "API"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "createEntityAuthFacade(options)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthProvider"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "useEntityAuth()"
                    },
                    {
                      "type": "text",
                      "value": " → "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ facade, ea, snapshot, accessToken, refreshToken, loading, isAuthenticated, login, logout, applyTokens }"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "useMe<T>()"
                    },
                    {
                      "type": "text",
                      "value": " → "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ me: T | null, loading }"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "useUserProfile()"
                    },
                    {
                      "type": "text",
                      "value": " → "
                    },
                    {
                      "type": "inlineCode",
                      "value": "{ me, oauthCredentials, hasPasswordCredential, isLoading }"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "notes",
          "children": [
            {
              "type": "text",
              "value": "Notes"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Peer deps: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "react >= 18"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Framework-agnostic: works with CRA, Vite, Remix, Next.js."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "The provider calls "
                    },
                    {
                      "type": "inlineCode",
                      "value": "facade.ready()"
                    },
                    {
                      "type": "text",
                      "value": " by default ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "autoReady={true}"
                    },
                    {
                      "type": "text",
                      "value": "); set "
                    },
                    {
                      "type": "inlineCode",
                      "value": "autoReady={false}"
                    },
                    {
                      "type": "text",
                      "value": " if you want to control bootstrapping manually."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "createEntityAuthFacade"
                    },
                    {
                      "type": "text",
                      "value": " persists refresh tokens in "
                    },
                    {
                      "type": "inlineCode",
                      "value": "localStorage"
                    },
                    {
                      "type": "text",
                      "value": " by default. Pass "
                    },
                    {
                      "type": "inlineCode",
                      "value": "persistRefreshToken: false"
                    },
                    {
                      "type": "text",
                      "value": " to opt out."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "see-also",
          "children": [
            {
              "type": "text",
              "value": "See also"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Framework guide: "
                    },
                    {
                      "type": "link",
                      "url": "/docs/frameworks",
                      "children": [
                        {
                          "type": "text",
                          "value": "/docs/frameworks"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Convex React adapter: "
                    },
                    {
                      "type": "link",
                      "url": "/docs/integrations/convex-react",
                      "children": [
                        {
                          "type": "text",
                          "value": "/docs/integrations/convex-react"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Install",
        "id": "install",
        "depth": 2,
        "children": []
      },
      {
        "title": "Usage",
        "id": "usage",
        "depth": 2,
        "children": [
          {
            "title": "Access auth state and user",
            "id": "access-auth-state-and-user",
            "depth": 3,
            "children": []
          },
          {
            "title": "User profile helpers",
            "id": "user-profile-helpers",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "API",
        "id": "api",
        "depth": 2,
        "children": []
      },
      {
        "title": "Notes",
        "id": "notes",
        "depth": 2,
        "children": []
      },
      {
        "title": "See also",
        "id": "see-also",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "sdk-swift"
    ],
    "url": "/sdk-swift",
    "frontmatter": {
      "title": "Swift SDK vNext",
      "description": "Modular Swift SDK mirroring the new web architecture"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Import "
            },
            {
              "type": "inlineCode",
              "value": "EntityKit"
            },
            {
              "type": "text",
              "value": " and create a facade instance that you manage (typically via a view model)."
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "import EntityKit\n\nlet facade = EntityAuthFacade(\n    config: EntityAuthConfig(\n        environment: .production,\n        workspaceTenantId: \"tenant_123\",\n        clientIdentifier: \"ios-app\"\n    )\n)"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "architecture-overview",
          "children": [
            {
              "type": "text",
              "value": "Architecture overview"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthCore"
                    },
                    {
                      "type": "text",
                      "value": " — configuration, token/keychain storage, unified "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthError"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthNetworking"
                    },
                    {
                      "type": "text",
                      "value": " — composable "
                    },
                    {
                      "type": "inlineCode",
                      "value": "APIClient"
                    },
                    {
                      "type": "text",
                      "value": " with automatic refresh + typed requests."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthDomain"
                    },
                    {
                      "type": "text",
                      "value": " — DTOs, services, and the high-level "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthFacade"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthRealtime"
                    },
                    {
                      "type": "text",
                      "value": " — Convex-backed realtime coordinator powering live snapshots."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "This mirrors the TypeScript SDK: networking + domain logic are decoupled from consumption, and realtime flows share a single coordinator."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "facade-api-",
          "children": [
            {
              "type": "text",
              "value": "Facade API ("
            },
            {
              "type": "inlineCode",
              "value": "EntityAuthFacade"
            },
            {
              "type": "text",
              "value": ")"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let snapshot = await facade.currentSnapshot()\nprint(snapshot.userId)\n\nlet stream = await facade.snapshotStream()\nfor await value in stream {\n    print(\"active org\", value.activeOrganization?.orgId ?? \"none\")\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "auth",
          "children": [
            {
              "type": "text",
              "value": "Auth"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "register(request:)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "login(request:)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "refreshTokens()"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "logout()"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "do {\n    try await facade.login(request: LoginRequest(\n        email: \"user@example.com\",\n        password: \"secure-password\",\n        workspaceTenantId: \"tenant_123\"\n    ))\n} catch {\n    // handle error\n}"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await facade.register(request: RegisterRequest(\n    email: \"first@acme.com\",\n    password: \"super-secure\",\n    workspaceTenantId: \"tenant_123\",\n    defaultWorkspaceRole: .owner\n))"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If omitted, the user will not be granted workspace owner/admin; organization creation will be forbidden by policy.\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "organizations",
          "children": [
            {
              "type": "text",
              "value": "Organizations"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let orgs = try await facade.organizations()\nlet active = try await facade.activeOrganization()\n\ntry await facade.createOrganization(name: \"Acme\", slug: \"acme\", ownerId: userId)\ntry await facade.switchOrg(orgId: \"org_123\")"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "entities-universal",
          "children": [
            {
              "type": "text",
              "value": "Entities (universal)"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let entities = EntitiesService(client: facade.currentDependencies.apiClient)\nlet list = try await entities.list(\n    workspaceTenantId: \"YOUR_TENANT_ID\",\n    kind: \"user\",\n    filter: ListEntitiesFilter(status: \"active\"),\n    limit: 25\n)\nlet upserted = try await entities.upsert(\n    workspaceTenantId: \"YOUR_TENANT_ID\",\n    kind: \"user\",\n    properties: [\"email\": \"a@b.com\"],\n    metadata: nil\n)"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "users",
          "children": [
            {
              "type": "text",
              "value": "Users"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Use the facade helpers for the most common flows:"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "try await facade.setUsername(\"alice\")\nlet available = try await facade.checkUsername(\"alice\")"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "sessions",
          "children": [
            {
              "type": "text",
              "value": "Sessions"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let current = try await facade.sessionService.current()\nlet sessions = try await facade.sessionService.list(includeRevoked: true)"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "helpers",
          "children": [
            {
              "type": "text",
              "value": "Helpers"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "snapshotStream()"
                    },
                    {
                      "type": "text",
                      "value": " → AsyncStream of unified state"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "snapshotPublisher"
                    },
                    {
                      "type": "text",
                      "value": " (Combine) if you bridge the subject"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "fetchGraphQL(query:variables:)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "openapi-graphql",
          "children": [
            {
              "type": "text",
              "value": "OpenAPI & GraphQL"
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "struct Viewer: Decodable { let me: Me }\nlet query = \"\"\"\nquery Viewer {\n  me { id email }\n}\n\"\"\"\n\nlet result: Viewer = try await facade.fetchGraphQL(query: query, variables: nil)\nprint(result.me.id)"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "cross-origin",
          "children": [
            {
              "type": "text",
              "value": "Cross-Origin"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Native clients use a refresh header stored in Keychain; no cookie configuration required. Ensure the server has "
            },
            {
              "type": "inlineCode",
              "value": "EA_CROSS_ORIGIN_COOKIES"
            },
            {
              "type": "text",
              "value": " enabled if your web apps are cross-origin."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "realtime",
          "children": [
            {
              "type": "text",
              "value": "Realtime"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "The facade creates a "
                    },
                    {
                      "type": "inlineCode",
                      "value": "RealtimeCoordinator"
                    },
                    {
                      "type": "text",
                      "value": " backed by Convex subscriptions."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "After login it automatically watches: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "users"
                    },
                    {
                      "type": "text",
                      "value": " collection for username, memberships for organizations, and the active session document."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Remote revocation publishes a "
                    },
                    {
                      "type": "inlineCode",
                      "value": ".sessionInvalid"
                    },
                    {
                      "type": "text",
                      "value": " event that clears tokens and drops the snapshot."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Logout tears down subscriptions and clears cached Convex clients ensured by "
                    },
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthRealtime"
                    },
                    {
                      "type": "text",
                      "value": "."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "best-practices",
          "children": [
            {
              "type": "text",
              "value": "Best practices"
            }
          ]
        },
        {
          "type": "code",
          "code": "The SDK automatically stores refresh tokens in Keychain for secure persistence across app launches.\n\n```swift\n// Token storage is handled automatically\ntry await auth.login(request: .init(email: \"user@example.com\", password: \"password\"))\n// Refresh token is now securely stored in Keychain\n```"
        },
        {
          "type": "code",
          "code": "Prefer the SDK request helper `fetch(_:method:headers:body:authorized:)`, which refreshes on 401 and retries automatically. For fully custom `URLSession` flows, manually call `refresh()` when receiving 401 responses.\n\n```swift\n// Using the helper (recommended)\nlet data = try await auth.fetch(\"/api/protected\", method: \"GET\")\n\n// If you roll your own URLSession requests:\nvar request = URLRequest(url: url)\nrequest.setValue(\"Bearer \\(auth.currentSnapshot().accessToken ?? \"\")\", forHTTPHeaderField: \"Authorization\")\nlet (_, response) = try await URLSession.shared.data(for: request)\nif let http = response as? HTTPURLResponse, http.statusCode == 401 {\n    _ = try await auth.refreshTokens()\n    // Retry with new token...\n}\n```"
        },
        {
          "type": "code",
          "code": "Use Combine to observe token changes, and rely on built-in realtime watchers after login.\n\n```swift\nlet stream = auth.snapshotStream()\nTask {\n    for await state in stream {\n        print(\"active org\", state.activeOrganization?.orgId ?? \"none\")\n    }\n}\n```"
        }
      ]
    },
    "toc": [
      {
        "title": "Architecture overview",
        "id": "architecture-overview",
        "depth": 2,
        "children": []
      },
      {
        "title": "Facade API ()",
        "id": "facade-api-",
        "depth": 2,
        "children": [
          {
            "title": "Auth",
            "id": "auth",
            "depth": 3,
            "children": []
          },
          {
            "title": "Organizations",
            "id": "organizations",
            "depth": 3,
            "children": []
          },
          {
            "title": "Entities (universal)",
            "id": "entities-universal",
            "depth": 3,
            "children": []
          },
          {
            "title": "Users",
            "id": "users",
            "depth": 3,
            "children": []
          },
          {
            "title": "Sessions",
            "id": "sessions",
            "depth": 3,
            "children": []
          },
          {
            "title": "Helpers",
            "id": "helpers",
            "depth": 3,
            "children": []
          },
          {
            "title": "OpenAPI & GraphQL",
            "id": "openapi-graphql",
            "depth": 3,
            "children": []
          },
          {
            "title": "Cross-Origin",
            "id": "cross-origin",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Realtime",
        "id": "realtime",
        "depth": 2,
        "children": []
      },
      {
        "title": "Best practices",
        "id": "best-practices",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "setup-basic"
    ],
    "url": "/setup-basic",
    "frontmatter": {
      "title": "Basic Setup Template",
      "description": "Set up Next.js with Entity Auth in one command"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "heading",
          "depth": 2,
          "id": "overview",
          "children": [
            {
              "type": "text",
              "value": "Overview"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The basic setup template scaffolds a complete Next.js application with Entity Auth integration out of the box. Run one command and get:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Next.js 15+ with TypeScript and Turbopack"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Entity Auth SDK configured and initialized"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "React Context provider with "
                    },
                    {
                      "type": "inlineCode",
                      "value": "useAuth()"
                    },
                    {
                      "type": "text",
                      "value": " hook"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Protected route middleware"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Environment variable template"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Pre-built "
                    },
                    {
                      "type": "inlineCode",
                      "value": "AuthForm"
                    },
                    {
                      "type": "text",
                      "value": " UI component with tabs for login/register"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "shadcn/ui automatically installed and configured"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "quick-start",
          "children": [
            {
              "type": "text",
              "value": "Quick Start"
            }
          ]
        },
        {
          "type": "code",
          "code": "```bash\nnpx @entityauth/cli@latest setup run entity-auth --node entityauth:setup:basic\n```\n\nThis will:\n1. Run `npx create-next-app@latest` with TypeScript and Turbopack\n2. Install and configure shadcn/ui with all components\n3. Create an `entity-auth/` directory with all integration files\n4. Include a `components/` subdirectory with the `AuthForm` UI component\n5. Generate a `.env.local.example` with placeholder values"
        },
        {
          "type": "code",
          "code": "Copy the example file and fill in your workspace credentials:\n\n```bash\ncp entity-auth/.env.local.example .env.local\n```\n\nGet your credentials from the [Entity Auth Dashboard](https://entity-auth.com/dashboard):\n1. Create or select a workspace\n2. Go to the **Setup** tab\n3. Copy your tenant ID and URL\n\nYour `.env.local` should look like:\n\n```bash\nENTITY_AUTH_WORKSPACE_TENANT_ID=ws_prod_abc123\nNEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID=ws_prod_abc123\nNEXT_PUBLIC_ENTITY_AUTH_URL=https://ws_prod_abc123.entity-auth.com\n```"
        },
        {
          "type": "code",
          "code": "```bash\npnpm add @entityauth/auth-client @entityauth/react\n```"
        },
        {
          "type": "code",
          "code": "Update your root layout to include the provider from `@entityauth/react` and initialize the SDK once:\n\n```tsx title=\"app/layout.tsx\"\nimport { init as initEA } from '@entityauth/auth-client';\nimport { EntityAuthProvider } from '@entityauth/react';\n\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nexport default function RootLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <EntityAuthProvider>\n          {children}\n        </EntityAuthProvider>\n      </body>\n    </html>\n  );\n}\n```"
        },
        {
          "type": "code",
          "code": "```tsx title=\"app/dashboard/page.tsx\"\n'use client';\n\nimport { useAuth } from '../../entity-auth/auth-provider';\n\nexport default function Dashboard() {\n  const { user, isAuthenticated, loading, logout } = useAuth();\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  if (!isAuthenticated) {\n    return <div>Please log in</div>;\n  }\n\n  return (\n    <div>\n      <h1>Welcome, {user?.email}</h1>\n      <button onClick={logout}>Logout</button>\n    </div>\n  );\n}\n```"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "whats-included",
          "children": [
            {
              "type": "text",
              "value": "What's Included"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The setup creates an "
            },
            {
              "type": "inlineCode",
              "value": "entity-auth/"
            },
            {
              "type": "text",
              "value": " directory with these files:"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "",
          "children": [
            {
              "type": "inlineCode",
              "value": "auth-client.tsx"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Initializes the Entity Auth SDK and exports a singleton client instance."
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID || '',\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nexport const entityAuthClient = new EntityAuthClient({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "",
          "children": [
            {
              "type": "inlineCode",
              "value": "auth-provider.tsx"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "React Context provider with authentication state and methods:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "State"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": "
                    },
                    {
                      "type": "inlineCode",
                      "value": "user"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "isAuthenticated"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "loading"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Methods"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": "
                    },
                    {
                      "type": "inlineCode",
                      "value": "login(email, password)"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "register(email, password)"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "logout()"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "refresh()"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Client"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Direct access via "
                    },
                    {
                      "type": "inlineCode",
                      "value": "client"
                    },
                    {
                      "type": "text",
                      "value": " property"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Hooks"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": "
                    },
                    {
                      "type": "inlineCode",
                      "value": "useAuth()"
                    },
                    {
                      "type": "text",
                      "value": " and "
                    },
                    {
                      "type": "inlineCode",
                      "value": "useRequireAuth()"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Features:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Automatically loads user on mount"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Listens for token changes (logout, refresh)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Auto-login after registration"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Error handling with user-friendly messages"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "",
          "children": [
            {
              "type": "inlineCode",
              "value": "middleware.ts"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Next.js middleware for route protection:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Redirects unauthenticated users from protected routes ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "/dashboard"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/profile"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/settings"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Redirects authenticated users away from auth pages ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "/login"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "/register"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Checks "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ea_refresh"
                    },
                    {
                      "type": "text",
                      "value": " cookie for authentication state"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Preserves redirect parameter for post-login navigation"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "",
          "children": [
            {
              "type": "inlineCode",
              "value": ".env.local.example"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Template with all required environment variables. Just replace placeholders with your actual values from the dashboard."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "",
          "children": [
            {
              "type": "inlineCode",
              "value": "components/auth-form.tsx"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "A production-ready authentication UI component built with shadcn/ui that includes:"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Tabbed interface"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Switch between login and register views"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Fully integrated"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Works seamlessly with the EntityAuthClient"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Customizable"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Props for redirects, titles, branding, error/success handlers"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Auto-redirect"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Automatically redirects authenticated users"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Form validation"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Email and password validation"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Error handling"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": ": Built-in error display with customizable handlers"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Key features:"
                }
              ]
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Uses shadcn/ui components ("
                    },
                    {
                      "type": "inlineCode",
                      "value": "Button"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Card"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Input"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Label"
                    },
                    {
                      "type": "text",
                      "value": ", "
                    },
                    {
                      "type": "inlineCode",
                      "value": "Tabs"
                    },
                    {
                      "type": "text",
                      "value": ")"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Auto-login after registration"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Logout button when already authenticated"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Customizable brand name, titles, and descriptions"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Optional header and back link"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Type-safe with full TypeScript support"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "usage-examples",
          "children": [
            {
              "type": "text",
              "value": "Usage Examples"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "using-the-pre-built-authform-component",
          "children": [
            {
              "type": "text",
              "value": "Using the Pre-built AuthForm Component"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The easiest way to add authentication to your app is to use the included "
            },
            {
              "type": "inlineCode",
              "value": "AuthForm"
            },
            {
              "type": "text",
              "value": " component:"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "'use client';\n\n\n\nexport default function AuthPage() {\n  return (\n    <AuthForm\n      client={entityAuthClient}\n      redirectTo=\"/dashboard\"\n      title=\"Welcome\"\n      description=\"Sign in to your account or create a new one\"\n      brandName=\"My App\"\n    />\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "custom-login-form",
          "children": [
            {
              "type": "text",
              "value": "Custom Login Form"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If you need a custom UI, you can build your own form using the "
            },
            {
              "type": "inlineCode",
              "value": "useAuth"
            },
            {
              "type": "text",
              "value": " hook:"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "'use client';\n\n\n\nexport default function LoginPage() {\n  const { login, isAuthenticated } = useAuth();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    const result = await login(email, password);\n    if (!result.success) {\n      setError(result.error || 'Login failed');\n    }\n  };\n\n  if (isAuthenticated) {\n    return <div>Already logged in!</div>;\n  }\n\n  return (\n    <form onSubmit={handleSubmit}>\n      {error && <div style={{ color: 'red' }}>{error}</div>}\n      <input\n        type=\"email\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        placeholder=\"Email\"\n        required\n      />\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        required\n      />\n      <button type=\"submit\">Login</button>\n    </form>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "registration-form",
          "children": [
            {
              "type": "text",
              "value": "Registration Form"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "'use client';\n\n\n\nexport default function RegisterPage() {\n  const { register } = useAuth();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    const result = await register(email, password);\n    if (!result.success) {\n      setError(result.error || 'Registration failed');\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      {error && <div style={{ color: 'red' }}>{error}</div>}\n      <input\n        type=\"email\"\n        value={email}\n        onChange={(e) => setEmail(e.target.value)}\n        placeholder=\"Email\"\n        required\n      />\n      <input\n        type=\"password\"\n        value={password}\n        onChange={(e) => setPassword(e.target.value)}\n        placeholder=\"Password\"\n        required\n      />\n      <button type=\"submit\">Register</button>\n    </form>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "protected-route",
          "children": [
            {
              "type": "text",
              "value": "Protected Route"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "'use client';\n\n\nexport default function ProtectedPage() {\n  const { isAuthenticated, loading } = useRequireAuth();\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  if (!isAuthenticated) {\n    return <div>Access denied. Please log in.</div>;\n  }\n\n  return <div>Protected content here</div>;\n}"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "using-the-client-directly",
          "children": [
            {
              "type": "text",
              "value": "Using the Client Directly"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "For advanced use cases, access the client directly:"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "'use client';\n\n\nexport default function AdvancedPage() {\n  const { client } = useAuth();\n\n  const handleSetUsername = async () => {\n    try {\n      await client.setUsername({ username: 'newusername' });\n      console.log('Username set!');\n    } catch (error) {\n      console.error('Failed to set username:', error);\n    }\n  };\n\n  const handleSwitchOrg = async (orgId: string) => {\n    try {\n      await client.switchOrg({ orgId });\n      console.log('Switched organization!');\n    } catch (error) {\n      console.error('Failed to switch org:', error);\n    }\n  };\n\n  return (\n    <div>\n      <button onClick={handleSetUsername}>Set Username</button>\n      <button onClick={() => handleSwitchOrg('org_123')}>Switch Org</button>\n    </div>\n  );\n}"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "customization",
          "children": [
            {
              "type": "text",
              "value": "Customization"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "add-more-protected-routes",
          "children": [
            {
              "type": "text",
              "value": "Add More Protected Routes"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Edit the "
            },
            {
              "type": "inlineCode",
              "value": "PROTECTED_ROUTES"
            },
            {
              "type": "text",
              "value": " array in "
            },
            {
              "type": "inlineCode",
              "value": "middleware.ts"
            },
            {
              "type": "text",
              "value": ":"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "const PROTECTED_ROUTES = ['/dashboard', '/profile', '/settings', '/admin'];"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "modify-auth-routes",
          "children": [
            {
              "type": "text",
              "value": "Modify Auth Routes"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Update the "
            },
            {
              "type": "inlineCode",
              "value": "AUTH_ROUTES"
            },
            {
              "type": "text",
              "value": " array to change which pages authenticated users can't access:"
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "const AUTH_ROUTES = ['/login', '/register', '/forgot-password'];"
        },
        {
          "type": "heading",
          "depth": 3,
          "id": "extend-the-auth-context",
          "children": [
            {
              "type": "text",
              "value": "Extend the Auth Context"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Add custom methods to the provider by editing "
            },
            {
              "type": "inlineCode",
              "value": "auth-provider.tsx"
            },
            {
              "type": "text",
              "value": ":"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "const getOrganizations = useCallback(async () => {\n  try {\n    const orgs = await entityAuthClient.getUserOrganizations();\n    return orgs;\n  } catch (error) {\n    console.error('Failed to get organizations:', error);\n    return [];\n  }\n}, []);\n\n// Add to context value\nreturn (\n  <AuthContext.Provider\n    value={{\n      // ... existing values\n      getOrganizations,\n    }}\n  >\n    {children}\n  </AuthContext.Provider>\n);"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "authform-component-props",
          "children": [
            {
              "type": "text",
              "value": "AuthForm Component Props"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The "
            },
            {
              "type": "inlineCode",
              "value": "AuthForm"
            },
            {
              "type": "text",
              "value": " component accepts these props for customization:"
            }
          ]
        },
        {
          "type": "table",
          "align": [
            null,
            null,
            null,
            null
          ],
          "children": [
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Prop"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Type"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Default"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Description"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "client"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "EntityAuthClient"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "required"
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "The Entity Auth client instance"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "redirectTo"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "string"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "\"/dashboard\""
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Path to redirect after successful auth"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "showHeader"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "boolean"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "true"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Show header with branding"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "showBackLink"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "boolean"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "true"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Show back link at bottom"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "backLinkHref"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "string"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "\"/\""
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Href for the back link"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "title"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "string"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "\"Dashboard Access\""
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Card title text"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "description"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "string"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "\"Authenticate to access...\""
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Card description text"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "brandName"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "string"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "\"Entity Auth\""
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Brand name in header/footer"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "onError"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "function"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "undefined"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Custom error handler "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(error, action) => void"
                    }
                  ]
                }
              ]
            },
            {
              "type": "tableRow",
              "children": [
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "onSuccess"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "function"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "undefined"
                    }
                  ]
                },
                {
                  "type": "tableCell",
                  "children": [
                    {
                      "type": "text",
                      "value": "Custom success handler "
                    },
                    {
                      "type": "inlineCode",
                      "value": "(action) => void"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "next-steps",
          "children": [
            {
              "type": "text",
              "value": "Next Steps"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Read the "
                    },
                    {
                      "type": "link",
                      "url": "/docs/authentication",
                      "children": [
                        {
                          "type": "text",
                          "value": "Authentication guide"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " for advanced patterns"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Explore "
                    },
                    {
                      "type": "link",
                      "url": "/docs/organizations",
                      "children": [
                        {
                          "type": "text",
                          "value": "Organizations"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " for multi-tenant features"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Check out the "
                    },
                    {
                      "type": "link",
                      "url": "/docs/frameworks",
                      "children": [
                        {
                          "type": "text",
                          "value": "Framework Integration"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " guide for more hooks"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Overview",
        "id": "overview",
        "depth": 2,
        "children": []
      },
      {
        "title": "Quick Start",
        "id": "quick-start",
        "depth": 2,
        "children": []
      },
      {
        "title": "What's Included",
        "id": "whats-included",
        "depth": 2,
        "children": [
          {
            "title": "",
            "id": "",
            "depth": 3,
            "children": []
          },
          {
            "title": "",
            "id": "",
            "depth": 3,
            "children": []
          },
          {
            "title": "",
            "id": "",
            "depth": 3,
            "children": []
          },
          {
            "title": "",
            "id": "",
            "depth": 3,
            "children": []
          },
          {
            "title": "",
            "id": "",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Usage Examples",
        "id": "usage-examples",
        "depth": 2,
        "children": [
          {
            "title": "Using the Pre-built AuthForm Component",
            "id": "using-the-pre-built-authform-component",
            "depth": 3,
            "children": []
          },
          {
            "title": "Custom Login Form",
            "id": "custom-login-form",
            "depth": 3,
            "children": []
          },
          {
            "title": "Registration Form",
            "id": "registration-form",
            "depth": 3,
            "children": []
          },
          {
            "title": "Protected Route",
            "id": "protected-route",
            "depth": 3,
            "children": []
          },
          {
            "title": "Using the Client Directly",
            "id": "using-the-client-directly",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "Customization",
        "id": "customization",
        "depth": 2,
        "children": [
          {
            "title": "Add More Protected Routes",
            "id": "add-more-protected-routes",
            "depth": 3,
            "children": []
          },
          {
            "title": "Modify Auth Routes",
            "id": "modify-auth-routes",
            "depth": 3,
            "children": []
          },
          {
            "title": "Extend the Auth Context",
            "id": "extend-the-auth-context",
            "depth": 3,
            "children": []
          }
        ]
      },
      {
        "title": "AuthForm Component Props",
        "id": "authform-component-props",
        "depth": 2,
        "children": []
      },
      {
        "title": "Next Steps",
        "id": "next-steps",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "sso"
    ],
    "url": "/sso",
    "frontmatter": {
      "title": "Single Sign-On (SSO)",
      "description": "OAuth/OIDC sign-in with automatic cross-domain support"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "EntityAuth provides "
            },
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "shared SSO"
                }
              ]
            },
            {
              "type": "text",
              "value": " - one OAuth app (Google, GitHub) works for all tenants automatically. No per-tenant configuration needed!"
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "shared-sso-setup-one-time",
          "children": [
            {
              "type": "text",
              "value": "Shared SSO Setup (One-Time)"
            }
          ]
        },
        {
          "type": "code",
          "language": "bash",
          "code": "# Google OAuth (create at https://console.cloud.google.com)\nGOOGLE_CLIENT_ID=your-google-client-id\nGOOGLE_CLIENT_SECRET=your-google-client-secret\n\n# GitHub OAuth (create at https://github.com/settings/developers)\nGITHUB_CLIENT_ID=your-github-client-id\nGITHUB_CLIENT_SECRET=your-github-client-secret\n\n# Token encryption\nEA_TOKEN_ENC_KEY=your-32-byte-hex-key\nEA_TOKEN_ENC_KEY_VERSION=1"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "OAuth Redirect URIs:"
                }
              ]
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Google: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://your-entity-auth-domain.com/api/auth/sso/callback"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "GitHub: "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://your-entity-auth-domain.com/api/auth/sso/callback"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "That's it! All workspaces now have Google and GitHub SSO."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "same-domain-sso-easiest",
          "children": [
            {
              "type": "text",
              "value": "Same-Domain SSO (Easiest)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If your app is on the "
            },
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "same domain"
                }
              ]
            },
            {
              "type": "text",
              "value": " as EntityAuth (e.g., both on "
            },
            {
              "type": "inlineCode",
              "value": "entity-auth.com"
            },
            {
              "type": "text",
              "value": "):"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\n<AuthForm \n  client={ea} \n  workspaceTenantId=\"your-tenant\"\n  redirectTo=\"/dashboard\"\n/>"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The user clicks \"Sign in with Google\", completes OAuth, and is redirected back with a session cookie. "
            },
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "It just works!"
                }
              ]
            },
            {
              "type": "text",
              "value": "\n"
            },
            {
              "type": "text",
              "value": ""
            },
            {
              "type": "text",
              "value": "\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "cross-domain-sso-different-domain",
          "children": [
            {
              "type": "text",
              "value": "Cross-Domain SSO (Different Domain)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "If your app is on a "
            },
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "different domain"
                }
              ]
            },
            {
              "type": "text",
              "value": " (e.g., "
            },
            {
              "type": "inlineCode",
              "value": "your-app.com"
            },
            {
              "type": "text",
              "value": " using EntityAuth on "
            },
            {
              "type": "inlineCode",
              "value": "entity-auth.com"
            },
            {
              "type": "text",
              "value": "):"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "For Next.js 13+ apps"
                }
              ]
            },
            {
              "type": "text",
              "value": ", create "
            },
            {
              "type": "inlineCode",
              "value": "middleware.ts"
            },
            {
              "type": "text",
              "value": " in your app root:"
            }
          ]
        },
        {
          "type": "code",
          "language": "typescript",
          "code": "\n\nexport function middleware(request: NextRequest) {\n  return entityAuthMiddleware(request, {\n    entityAuthUrl: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL || 'https://entity-auth.com',\n    workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID || '',\n    protectedRoutes: ['/dashboard/*', '/profile'],\n    publicRoutes: ['/'],\n    loginUrl: '/auth',\n  });\n}\n\nexport const config = {\n  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],\n};"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "What this does:"
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Detects SSO redirect with "
            },
            {
              "type": "inlineCode",
              "value": "__ea_ticket"
            },
            {
              "type": "text",
              "value": " parameter, exchanges ticket for refresh token "
            },
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "server-side"
                }
              ]
            },
            {
              "type": "text",
              "value": " (before page loads), sets cookie on your domain, redirects to clean URL, protects authenticated routes. Zero client-side complexity!"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Ensure your auth provider seeds the refresh token from the cookie:"
            }
          ]
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "\nconst ea = new EntityAuthClient({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nuseEffect(() => {\n  // Seed refresh token from cookie (set by middleware)\n  const cookieMatch = document.cookie.match(/(?:^|;\\s*)ea_refresh=([^;]+)/);\n  const cookieToken = cookieMatch?.[1];\n  if (cookieToken) {\n    localStorage.setItem(\"ea_refresh_token\", cookieToken);\n    ea.setRefreshToken(cookieToken);\n  }\n}, []);"
        },
        {
          "type": "code",
          "language": "tsx",
          "code": "async function loginWithGoogle() {\n  try {\n    const { authorizationUrl } = await client.startSSO({\n      provider: \"google\",\n      returnTo: \"/dashboard\",\n    });\n    window.location.href = authorizationUrl;\n  } catch (e) {\n    const error = e as Error;\n    alert(`Google sign-in error: ${error.message}`);\n  }\n}\n\nasync function loginWithGitHub() {\n  try {\n    const { authorizationUrl } = await client.startSSO({\n      provider: \"github\",\n      returnTo: \"/dashboard\",\n    });\n    window.location.href = authorizationUrl;\n  } catch (e) {\n    const error = e as Error;\n    alert(`GitHub sign-in error: ${error.message}`);\n  }\n}"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "strong",
              "children": [
                {
                  "type": "text",
                  "value": "Flow:"
                }
              ]
            }
          ]
        },
        {
          "type": "list",
          "ordered": true,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "User clicks \"Sign in with Google\""
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "client.startSSO()"
                    },
                    {
                      "type": "text",
                      "value": " calls Entity Auth service (uses configured baseURL)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Completes OAuth on EntityAuth"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "EntityAuth redirects to "
                    },
                    {
                      "type": "inlineCode",
                      "value": "https://your-app.com/dashboard?__ea_ticket=abc123"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "inlineCode",
                      "value": "TicketExchangeHandler"
                    },
                    {
                      "type": "text",
                      "value": " detects the ticket and exchanges it for a refresh token"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Refresh token is stored and user is authenticated!"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "mobile-sso-iosswift",
          "children": [
            {
              "type": "text",
              "value": "Mobile SSO (iOS/Swift)"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Mobile apps use the same ticket-based flow. See the "
            },
            {
              "type": "link",
              "url": "/docs/sdk-swift",
              "children": [
                {
                  "type": "text",
                  "value": "Swift SDK docs"
                }
              ]
            },
            {
              "type": "text",
              "value": " for details."
            }
          ]
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let sso = EntityAuthSSO(baseURL: URL(string: \"https://entity-auth.com\")!)\nlet result = try await sso.signIn(\n  provider: \"github\", \n  returnTo: URL(string: \"yourapp://auth\")!,\n  workspaceTenantId: \"your-tenant\"\n)\n// result = (accessToken, refreshToken, sessionId, userId)"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "security",
          "children": [
            {
              "type": "text",
              "value": "Security"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "PKCE enforced"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " (S256 method)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "State validation"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " with tenant prefix"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Nonce validation"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " for OpenID Connect"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Tickets expire in 60 seconds"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Single-use tickets"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " (can't be replayed)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "✅ "
                    },
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Workspace-scoped"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " tickets"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "supported-providers",
          "children": [
            {
              "type": "text",
              "value": "Supported Providers"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Google"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " (OpenID Connect)"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "GitHub"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " (OAuth 2.0)"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Want to add more? Implement a provider adapter with "
            },
            {
              "type": "inlineCode",
              "value": "buildAuthUrl"
            },
            {
              "type": "text",
              "value": ", "
            },
            {
              "type": "inlineCode",
              "value": "exchangeCode"
            },
            {
              "type": "text",
              "value": ", and "
            },
            {
              "type": "inlineCode",
              "value": "getUserProfile"
            },
            {
              "type": "text",
              "value": " in "
            },
            {
              "type": "inlineCode",
              "value": "src/lib/sso/providers/"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "Shared SSO Setup (One-Time)",
        "id": "shared-sso-setup-one-time",
        "depth": 2,
        "children": []
      },
      {
        "title": "Same-Domain SSO (Easiest)",
        "id": "same-domain-sso-easiest",
        "depth": 2,
        "children": []
      },
      {
        "title": "Cross-Domain SSO (Different Domain)",
        "id": "cross-domain-sso-different-domain",
        "depth": 2,
        "children": []
      },
      {
        "title": "Mobile SSO (iOS/Swift)",
        "id": "mobile-sso-iosswift",
        "depth": 2,
        "children": []
      },
      {
        "title": "Security",
        "id": "security",
        "depth": 2,
        "children": []
      },
      {
        "title": "Supported Providers",
        "id": "supported-providers",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "tenant-onboarding"
    ],
    "url": "/tenant-onboarding",
    "frontmatter": {
      "title": "Tenant Onboarding",
      "description": "Find your tenant ID and connect your app to Entity Auth"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Entity Auth is multi‑tenant. Each workspace you create has a unique tenant ID, API base URL, and allowed origins list. The dashboard generates these values for you."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "what-is-a-tenant-id",
          "children": [
            {
              "type": "text",
              "value": "What is a tenant ID?"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "The tenant ID (often shown as "
            },
            {
              "type": "inlineCode",
              "value": "tid"
            },
            {
              "type": "text",
              "value": ") identifies the active organization/workspace for a user session. Most APIs are scoped to the current tenant."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "get-your-tenant-id",
          "children": [
            {
              "type": "text",
              "value": "Get your tenant ID"
            }
          ]
        },
        {
          "type": "code",
          "code": "Go to the dashboard at `https://entity-auth.com/dashboard` and sign up."
        },
        {
          "type": "code",
          "code": "After sign‑in, create a new workspace/organization. This will generate a tenant for you."
        },
        {
          "type": "code",
          "code": "Open the workspace Setup tab. Copy the generated snippet—it contains `ENTITY_AUTH_WORKSPACE_TENANT_ID`, `NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID`, and `NEXT_PUBLIC_ENTITY_AUTH_URL`."
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "use-the-tenant-id-in-your-app",
          "children": [
            {
              "type": "text",
              "value": "Use the tenant ID in your app"
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Initialize the SDK once with the copied values. Never ask users for "
            },
            {
              "type": "inlineCode",
              "value": "workspaceTenantId"
            },
            {
              "type": "text",
              "value": "."
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "// Web / Node.js\n\ninitEA({\n  workspaceTenantId: process.env.NEXT_PUBLIC_ENTITY_AUTH_WORKSPACE_TENANT_ID!,\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nconst ea = new EntityAuthClient({\n  baseURL: process.env.NEXT_PUBLIC_ENTITY_AUTH_URL,\n});\n\nawait ea.login({\n  email: 'user@example.com',\n  password: 'secure-password',\n});"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "// Swift (iOS/macOS)\nimport EntityKit\n\nlet config = EntityAuthConfig(\n    environment: .production,\n    workspaceTenantId: \"your-tenant-id\",\n    clientIdentifier: \"ios-app\"\n)\nlet auth = EntityAuthFacade(config: config)\n\ntry await auth.login(request: .init(email: \"user@example.com\", password: \"secure-password\"))\nlet snapshot = await auth.currentSnapshot()\nprint(snapshot.userId ?? \"no user\")"
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "verify-it-works",
          "children": [
            {
              "type": "text",
              "value": "Verify it works"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "After login, call "
                    },
                    {
                      "type": "inlineCode",
                      "value": "ea.getUserMe()"
                    },
                    {
                      "type": "text",
                      "value": " (Web) or inspect "
                    },
                    {
                      "type": "inlineCode",
                      "value": "auth.currentSnapshot()"
                    },
                    {
                      "type": "text",
                      "value": "/"
                    },
                    {
                      "type": "inlineCode",
                      "value": "auth.userService.me()"
                    },
                    {
                      "type": "text",
                      "value": " (Swift) to verify the session."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Create or switch organizations; the current tenant is reflected in the session context."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Check Allowed Origins in the dashboard to confirm your frontend domain is listed (localhost ports are seeded)."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "troubleshooting",
          "children": [
            {
              "type": "text",
              "value": "Troubleshooting"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Invalid tenant ID (401/404):"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " Ensure the "
                    },
                    {
                      "type": "inlineCode",
                      "value": ".env"
                    },
                    {
                      "type": "text",
                      "value": " values exactly match the dashboard snippet."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "CORS errors:"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " Add your app’s domain to the workspace Allowed Origins list and try again."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "strong",
                      "children": [
                        {
                          "type": "text",
                          "value": "Custom domain pending:"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " Verify the TXT record provided in the dashboard is present before clicking “Verify”."
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "next-steps",
          "children": [
            {
              "type": "text",
              "value": "Next steps"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Follow the "
                    },
                    {
                      "type": "link",
                      "url": "/docs/frameworks",
                      "children": [
                        {
                          "type": "text",
                          "value": "Framework Integration"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " guide (React/Next.js)."
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "text",
                      "value": "Explore the "
                    },
                    {
                      "type": "link",
                      "url": "/docs/demo",
                      "children": [
                        {
                          "type": "text",
                          "value": "Demo Dashboard guide"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " to replicate advanced features."
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "What is a tenant ID?",
        "id": "what-is-a-tenant-id",
        "depth": 2,
        "children": []
      },
      {
        "title": "Get your tenant ID",
        "id": "get-your-tenant-id",
        "depth": 2,
        "children": []
      },
      {
        "title": "Use the tenant ID in your app",
        "id": "use-the-tenant-id-in-your-app",
        "depth": 2,
        "children": []
      },
      {
        "title": "Verify it works",
        "id": "verify-it-works",
        "depth": 2,
        "children": []
      },
      {
        "title": "Troubleshooting",
        "id": "troubleshooting",
        "depth": 2,
        "children": []
      },
      {
        "title": "Next steps",
        "id": "next-steps",
        "depth": 2,
        "children": []
      }
    ]
  },
  {
    "slug": [
      "users"
    ],
    "url": "/users",
    "frontmatter": {
      "title": "Users",
      "description": "Profile endpoints and username helpers"
    },
    "content": {
      "type": "root",
      "children": [
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Common user endpoints and helpers."
            }
          ]
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "<Tabs items={[\"Web\",\"Swift\"]}>\n"
            },
            {
              "type": "text",
              "value": ""
            }
          ]
        },
        {
          "type": "code",
          "language": "ts",
          "code": "const me = await ea.me();\nconsole.log(me.id, me.email);"
        },
        {
          "type": "code",
          "language": "swift",
          "code": "let config = EntityAuthConfig(\n    environment: .production,\n    workspaceTenantId: \"your-tenant-id\",\n    clientIdentifier: \"ios-app\"\n)\nlet auth = EntityAuthFacade(config: config)\n\n// Username flows are handled via generic entity updates; no direct HTTP helpers.\nlet snapshot = await auth.currentSnapshot()\nprint(snapshot.userId ?? \"none\")"
        },
        {
          "type": "paragraph",
          "children": [
            {
              "type": "text",
              "value": "Validation rules: lowercase letters, digits, "
            },
            {
              "type": "inlineCode",
              "value": "."
            },
            {
              "type": "text",
              "value": " "
            },
            {
              "type": "inlineCode",
              "value": "_"
            },
            {
              "type": "text",
              "value": " "
            },
            {
              "type": "inlineCode",
              "value": "-"
            },
            {
              "type": "text",
              "value": ", 3–30 chars."
            }
          ]
        },
        {
          "type": "heading",
          "depth": 2,
          "id": "see-also",
          "children": [
            {
              "type": "text",
              "value": "See also"
            }
          ]
        },
        {
          "type": "list",
          "ordered": false,
          "children": [
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "link",
                      "url": "/docs/frameworks",
                      "children": [
                        {
                          "type": "text",
                          "value": "Framework Integration"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " — profile hook patterns"
                    }
                  ]
                }
              ]
            },
            {
              "type": "listItem",
              "children": [
                {
                  "type": "paragraph",
                  "children": [
                    {
                      "type": "link",
                      "url": "/docs/demo",
                      "children": [
                        {
                          "type": "text",
                          "value": "Demo Dashboard Guide"
                        }
                      ]
                    },
                    {
                      "type": "text",
                      "value": " — username UI with validation"
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    "toc": [
      {
        "title": "See also",
        "id": "see-also",
        "depth": 2,
        "children": []
      }
    ]
  }
]